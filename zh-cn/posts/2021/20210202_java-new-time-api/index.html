<!doctype html><html lang=zh-CN dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
mybatis自 3.4.5 开始，已经支持使用LocaldateTime作为时间查询入参，映射类型为TimeStamp，参考地址: 
  https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers

  1 前言
  #

在介绍Java SE 8中新的日期时间库前，先了解下Java 8之前的日期时间工具的诟病。
在Java SE 8前，日期时间工具库在java.util包中，包括：

java.util.Date：表示日期和时间
java.util.Calendar以及其实现子类：表示各种日历系统，常用的是格林威治日历java.util.GregorianCalendar
java.util.TimeZone以及其实现子类：表示时区偏移量和夏令时

以及辅助其进行格式化和解析的工具库在java.text包中，包括：

java.text.DateFormat：格式化日期时间和解析日期时间的工具抽象类
java.text.SimpleDateFormat：DateDateFormat的实现
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://wangy325.github.io/zh-cn/posts/2021/20210202_java-new-time-api/"><meta property="og:site_name" content="xf&pl"><meta property="og:title" content="Java8日期和时间API"><meta property="og:description" content="mybatis自 3.4.5 开始，已经支持使用LocaldateTime作为时间查询入参，映射类型为TimeStamp，参考地址: https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers
1 前言 # 在介绍Java SE 8中新的日期时间库前，先了解下Java 8之前的日期时间工具的诟病。
在Java SE 8前，日期时间工具库在java.util包中，包括：
java.util.Date：表示日期和时间 java.util.Calendar以及其实现子类：表示各种日历系统，常用的是格林威治日历java.util.GregorianCalendar java.util.TimeZone以及其实现子类：表示时区偏移量和夏令时 以及辅助其进行格式化和解析的工具库在java.text包中，包括：
java.text.DateFormat：格式化日期时间和解析日期时间的工具抽象类 java.text.SimpleDateFormat：DateDateFormat的实现"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-02T00:00:00+08:00"><meta property="article:modified_time" content="2025-03-02T15:24:50+08:00"><title>Java8日期和时间API | xf&amp;pl</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://wangy325.github.io/zh-cn/posts/2021/20210202_java-new-time-api/><link rel=stylesheet href=/book.min.b3c35582f793f8698430900c951e043987ef545ae9292888a87c0d14a3f9e018.css integrity="sha256-s8NVgveT+GmEMJAMlR4EOYfvVFrpKSiIqHwNFKP54Bg=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/zh-cn.search.min.aef32b9e1c651232f5ac6955b666d719cd78de8420bba3693c7e4d0fd7c86f52.js integrity="sha256-rvMrnhxlEjL1rGlVtmbXGc143oQgu6NpPH5ND9fIb1I=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-HHNKR5H8KN"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HHNKR5H8KN")}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=navi-bar id=navibar><div id=page-title><h2 class=book-brand><a class="flex align-center" href=/zh-cn/><span>xf&amp;pl</span></a></h2></div><div class=page-navi-col><nav><ul><li class=book-section-flat><a href=/zh-cn/docs/java/>Java</a><ul><li><a role=button>面向对象</a><ul><li><a href=/zh-cn/docs/java/basic/1_%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E4%BF%AE%E9%A5%B0%E7%AC%A6/>访问权限修饰符</a></li><li><a href=/zh-cn/docs/java/basic/2_static%E5%85%B3%E9%94%AE%E5%AD%97/>static关键字</a></li><li><a href=/zh-cn/docs/java/basic/3_%E4%BC%A0%E5%80%BC%E8%BF%98%E6%98%AF%E4%BC%A0%E5%BC%95%E7%94%A8/>传值还是传引用</a></li><li><a href=/zh-cn/docs/java/basic/4_final%E5%85%B3%E9%94%AE%E5%AD%97/>final关键字</a></li><li><a href=/zh-cn/docs/java/basic/5_Object%E8%B6%85%E7%B1%BB/>Object超类</a></li><li><a href=/zh-cn/docs/java/basic/5_%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A%E4%B8%8E%E9%9D%99%E6%80%81%E7%BB%91%E5%AE%9A/>动态绑定与静态绑定</a></li><li><a href=/zh-cn/docs/java/basic/6_%E6%8A%BD%E8%B1%A1%E7%B1%BB%E4%B8%8E%E6%8E%A5%E5%8F%A3/>抽象类与接口</a></li><li><a href=/zh-cn/docs/java/basic/7_lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/>Lambda与函数式接口</a></li><li><a href=/zh-cn/docs/java/basic/8_%E5%86%85%E9%83%A8%E7%B1%BB/>内部类</a></li></ul></li><li><a href=/zh-cn/docs/java/collections/>集合框架</a><ul><li><a href=/zh-cn/docs/java/collections/1_List_arraylist/>ArrayList</a></li><li><a href=/zh-cn/docs/java/collections/1_List_linkedlist/>LinkedList</a></li><li><a href=/zh-cn/docs/java/collections/2_Queue/>Queue</a></li><li><a href=/zh-cn/docs/java/collections/3_Set/>Set</a></li><li><a href=/zh-cn/docs/java/collections/4_Map_hash_tree_map/>HashMap和TreeMap</a></li><li><a href=/zh-cn/docs/java/collections/4_Map_linkedhashmap/>LinkedHashMap</a></li><li><a href=/zh-cn/docs/java/collections/5_HashMap%E7%9A%84%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/>HashMap的源码分析</a></li><li><a href=/zh-cn/docs/java/collections/6_Collections/>Collections工具类</a></li></ul></li><li><a href=/zh-cn/docs/java/concurrency/>并发</a><ul><li><a role=button>锁与同步</a><ul><li><a href=/zh-cn/docs/java/concurrency/conecptes/1%E7%BA%BF%E7%A8%8B%E4%B8%8E%E4%BB%BB%E5%8A%A1_1/>线程与任务(一)</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/1%E7%BA%BF%E7%A8%8B%E4%B8%8E%E4%BB%BB%E5%8A%A1_2/>线程与任务(二)</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_1/>资源访问受限--引论</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_2_%E9%94%81%E5%92%8C%E6%9D%A1%E4%BB%B6/>资源访问受限-锁和条件</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_3_synchronized/>synchronized关键字</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_4_%E5%8E%9F%E5%AD%90%E6%80%A7%E4%B8%8E%E5%8E%9F%E5%AD%90%E7%B1%BB/>原子性和可见性</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_5_%E7%BA%BF%E7%A8%8B%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8/>线程本地存储</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/3%E8%8E%B7%E5%8F%96%E4%BB%BB%E5%8A%A1%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC/>获取任务的返回值</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/4%E6%AD%BB%E9%94%81/>死锁问题2例</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/5%E7%BB%88%E7%BB%93%E4%BB%BB%E5%8A%A1/>终结任务</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/6%E7%94%9F%E4%BA%A7%E8%80%85-%E6%B6%88%E8%B4%B9%E8%80%85%E4%B8%8E%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97/>生产者-消费者与阻塞队列</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/6%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E4%BD%BF%E7%94%A82%E4%BE%8B/>阻塞队列的使用2例</a></li></ul></li><li><a role=button>线程池</a><ul><li><a href=/zh-cn/docs/java/concurrency/pools/7_1_Executors_and_ExecutorService/>Executors与Executor框架</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/7_2_ThreadPoolExecutor1/>ThreadPoolExecutor(一)</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/7_3_ThreadPoolExecutor2/>ThreadPoolExecutor(二)</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/7_4_CompletionService/>CompletionService</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/8_1_ScheduledExecutorService1/>ScheduledExecutorService(一)</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/8_2_ScheduledExecutorService2/>ScheduledExecutorService(二)</a></li></ul></li><li><a role=button>并发组件</a><ul><li><a href=/zh-cn/docs/java/concurrency/components/9_1_countdownlatch/>CountDownLatch</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_2_cyclicbarrier/>CyclicBarrier</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_3_semaphore/>Semaphore</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_4_exchanger/>Exchanger</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_5_priorityblockqueue_delayqueue/>PriorityBlockingQueue and DelayQueue</a></li></ul></li></ul></li><li><a role=button>JVM</a><ul><li><a href=/zh-cn/docs/java/jvm/Java%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E8%AF%A6%E8%A7%A3/>Java内存区域详解(转)</a></li><li><a href=/zh-cn/docs/java/jvm/java-gc/>JVM垃圾回收概要(转)</a></li><li><a href=/zh-cn/docs/java/jvm/10_Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8Evolatile%E5%85%B3%E9%94%AE%E5%AD%97/>JMM与volatile关键字(转)</a></li></ul></li></ul></li><li class=book-section-flat><span>Design Pattern</span><ul><li><a role=button>Creation</a><ul><li><a href=/zh-cn/docs/design_pattern/creation/20240328_singleton/>单例模式</a></li><li><a href=/zh-cn/docs/design_pattern/creation/20240326_factory/>工厂模式</a></li><li><a href=/zh-cn/docs/design_pattern/creation/20240326_abstract_factory/>抽象工厂模式</a></li><li><a href=/zh-cn/docs/design_pattern/creation/20240313_builder/>建造者模式</a></li></ul></li><li><a role=button>Behaviour</a><ul><li><a href=/zh-cn/docs/design_pattern/behaviour/20240329_command/>命令模式</a></li><li><a href=/zh-cn/docs/design_pattern/behaviour/20240308_observer/>观察者模式</a></li><li><a href=/zh-cn/docs/design_pattern/behaviour/20240307_strategy/>策略模式</a></li><li><a href=/zh-cn/docs/design_pattern/behaviour/20240402_template_method/>模板方法模式</a></li></ul></li><li><a role=button>Structural</a><ul><li><a href=/zh-cn/docs/design_pattern/structure/20240321_decorator/>装饰者模式</a></li><li><a href=/zh-cn/docs/design_pattern/structure/20240401_adaptor/>适配器模式</a></li><li><a href=/zh-cn/docs/design_pattern/structure/20240401_%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/>外观模式</a></li><li><a href=/zh-cn/docs/design_pattern/structure/20181205_proxy/>代理模式</a></li></ul></li></ul></li><li class=book-section-flat><span>Note</span><ul><li><a href=/zh-cn/docs/note/operating_system_peking/>操作系统原理</a><ul><li><a href=/zh-cn/docs/note/operating_system_peking/1_intro/>引论</a></li><li><a href=/zh-cn/docs/note/operating_system_peking/2_env_and_logic/>操作系统运行环境与机制</a></li><li><a href=/zh-cn/docs/note/operating_system_peking/3_processes_and_threads/>进程和线程模型</a></li></ul></li><li><a href=/zh-cn/docs/note/algorithms_part1/>算法-第一部分</a><ul></ul></li></ul></li><li class=book-section-flat><span>Snippets</span><ul><li><a role=button>Java</a><ul><li><a href=/zh-cn/docs/snippets/java/Gfunction/>Java接口作为方法入参</a></li><li><a href=/zh-cn/docs/snippets/java/Goto/>Java中使用goto语句？</a></li><li><a href=/zh-cn/docs/snippets/java/ImmutableStr/>Java字符串的不可变</a></li><li><a href=/zh-cn/docs/snippets/java/MainClass/>子类不能调用父类中定义的构造器来实例化</a></li><li><a href=/zh-cn/docs/snippets/java/StaticBlock/>静态代码块的行为</a></li><li><a href=/zh-cn/docs/snippets/java/Threading/>线程竞争</a></li><li><a href=/zh-cn/docs/snippets/java/TryF/>不要在finally块中返回值</a></li></ul></li><li><a role=button>Python</a><ul><li><a role=button>基本概念</a><ul><li><a href=/zh-cn/docs/snippets/pys/intro/1_flow_control/>流程控制语句</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/2_data_list/>列表（list）</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/3_data_str/>字符串，元组和字典</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/4_func/>函数式编程</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/4_important_funcs/>4个重要的内置函数</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/5_file_io/>格式化输出与文件I/O</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/6_try_excep/>异常处理</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/7_scope/>命名空间与作用域</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/8_class_type/>类与对象</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/9_decoration/>闭包与装饰器</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/10_decoration_2/>装饰器2</a></li></ul></li><li><a role=button>线程模型</a><ul><li><a href=/zh-cn/docs/snippets/pys/threading/11_threading/>初窥Python线程</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/12_threading_lock/>线程-锁</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/13_threading_condition/>线程-条件</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/14_threading_semaphore/>线程-信号量</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/15_threading_event/>线程-事件</a></li></ul></li></ul></li><li><a role=button>Gist</a><ul><li><a href=/zh-cn/docs/snippets/gist/clash_pro/>Clash Pro代理手动配置示例</a></li></ul></li></ul></li></ul><ul><li><a href=/zh-cn/posts/>Blog</a></li><li><a href=/zh-cn/archive/>Archive</a></li></ul></nav></div><div class="book-search hidden"><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/ required pattern=\S+.*>
<span class=clear_search><img src=/svg/close.svg onclick=clearInput()></span><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><script>function clearInput(){document.getElementById("book-search-input").value="";for(var e=document.getElementById("book-search-results");e.firstChild;)e.removeChild(e.firstChild)}</script><ul class=book-languages><li><a class="flex align-center"><img src=/svg/language.svg class=book-icon alt=Languages>
简体中文</a></label><ul><li><a href=https://wangy325.github.io/en/>English</a></li></ul></li></ul></div><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/zh-cn/><span>xf&amp;pl</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
简体中文</a></label><ul><li><a href=/en/>English</a></li></ul></li></ul><ul><li class=book-section-flat><a href=/zh-cn/docs/java/>Java</a><ul><li><input type=checkbox id=section-ca8cbfedb8cd9b17a23843dec39fe16d class=toggle>
<label for=section-ca8cbfedb8cd9b17a23843dec39fe16d class="flex justify-between"><a role=button>面向对象</a></label><ul><li><a href=/zh-cn/docs/java/basic/1_%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E4%BF%AE%E9%A5%B0%E7%AC%A6/>访问权限修饰符</a></li><li><a href=/zh-cn/docs/java/basic/2_static%E5%85%B3%E9%94%AE%E5%AD%97/>static关键字</a></li><li><a href=/zh-cn/docs/java/basic/3_%E4%BC%A0%E5%80%BC%E8%BF%98%E6%98%AF%E4%BC%A0%E5%BC%95%E7%94%A8/>传值还是传引用</a></li><li><a href=/zh-cn/docs/java/basic/4_final%E5%85%B3%E9%94%AE%E5%AD%97/>final关键字</a></li><li><a href=/zh-cn/docs/java/basic/5_Object%E8%B6%85%E7%B1%BB/>Object超类</a></li><li><a href=/zh-cn/docs/java/basic/5_%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A%E4%B8%8E%E9%9D%99%E6%80%81%E7%BB%91%E5%AE%9A/>动态绑定与静态绑定</a></li><li><a href=/zh-cn/docs/java/basic/6_%E6%8A%BD%E8%B1%A1%E7%B1%BB%E4%B8%8E%E6%8E%A5%E5%8F%A3/>抽象类与接口</a></li><li><a href=/zh-cn/docs/java/basic/7_lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/>Lambda与函数式接口</a></li><li><a href=/zh-cn/docs/java/basic/8_%E5%86%85%E9%83%A8%E7%B1%BB/>内部类</a></li></ul></li><li><input type=checkbox id=section-cc8f9a4be9c1f6095448be9e59bad591 class=toggle>
<label for=section-cc8f9a4be9c1f6095448be9e59bad591 class="flex justify-between"><a href=/zh-cn/docs/java/collections/>集合框架</a></label><ul><li><a href=/zh-cn/docs/java/collections/1_List_arraylist/>ArrayList</a></li><li><a href=/zh-cn/docs/java/collections/1_List_linkedlist/>LinkedList</a></li><li><a href=/zh-cn/docs/java/collections/2_Queue/>Queue</a></li><li><a href=/zh-cn/docs/java/collections/3_Set/>Set</a></li><li><a href=/zh-cn/docs/java/collections/4_Map_hash_tree_map/>HashMap和TreeMap</a></li><li><a href=/zh-cn/docs/java/collections/4_Map_linkedhashmap/>LinkedHashMap</a></li><li><a href=/zh-cn/docs/java/collections/5_HashMap%E7%9A%84%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/>HashMap的源码分析</a></li><li><a href=/zh-cn/docs/java/collections/6_Collections/>Collections工具类</a></li></ul></li><li><input type=checkbox id=section-3609ad9ce28a9e0e69f1d931292b83b8 class=toggle>
<label for=section-3609ad9ce28a9e0e69f1d931292b83b8 class="flex justify-between"><a href=/zh-cn/docs/java/concurrency/>并发</a></label><ul><li><input type=checkbox id=section-c4053730d867c308382c587fe6215972 class=toggle>
<label for=section-c4053730d867c308382c587fe6215972 class="flex justify-between"><a role=button>锁与同步</a></label><ul><li><a href=/zh-cn/docs/java/concurrency/conecptes/1%E7%BA%BF%E7%A8%8B%E4%B8%8E%E4%BB%BB%E5%8A%A1_1/>线程与任务(一)</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/1%E7%BA%BF%E7%A8%8B%E4%B8%8E%E4%BB%BB%E5%8A%A1_2/>线程与任务(二)</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_1/>资源访问受限--引论</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_2_%E9%94%81%E5%92%8C%E6%9D%A1%E4%BB%B6/>资源访问受限-锁和条件</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_3_synchronized/>synchronized关键字</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_4_%E5%8E%9F%E5%AD%90%E6%80%A7%E4%B8%8E%E5%8E%9F%E5%AD%90%E7%B1%BB/>原子性和可见性</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/2%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%8F%97%E9%99%90_5_%E7%BA%BF%E7%A8%8B%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8/>线程本地存储</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/3%E8%8E%B7%E5%8F%96%E4%BB%BB%E5%8A%A1%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC/>获取任务的返回值</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/4%E6%AD%BB%E9%94%81/>死锁问题2例</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/5%E7%BB%88%E7%BB%93%E4%BB%BB%E5%8A%A1/>终结任务</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/6%E7%94%9F%E4%BA%A7%E8%80%85-%E6%B6%88%E8%B4%B9%E8%80%85%E4%B8%8E%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97/>生产者-消费者与阻塞队列</a></li><li><a href=/zh-cn/docs/java/concurrency/conecptes/6%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E4%BD%BF%E7%94%A82%E4%BE%8B/>阻塞队列的使用2例</a></li></ul></li><li><input type=checkbox id=section-566ef64757d36b98fe67804b5c360ae8 class=toggle>
<label for=section-566ef64757d36b98fe67804b5c360ae8 class="flex justify-between"><a role=button>线程池</a></label><ul><li><a href=/zh-cn/docs/java/concurrency/pools/7_1_Executors_and_ExecutorService/>Executors与Executor框架</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/7_2_ThreadPoolExecutor1/>ThreadPoolExecutor(一)</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/7_3_ThreadPoolExecutor2/>ThreadPoolExecutor(二)</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/7_4_CompletionService/>CompletionService</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/8_1_ScheduledExecutorService1/>ScheduledExecutorService(一)</a></li><li><a href=/zh-cn/docs/java/concurrency/pools/8_2_ScheduledExecutorService2/>ScheduledExecutorService(二)</a></li></ul></li><li><input type=checkbox id=section-3e279b5e02791c6f975beaf42ab8da60 class=toggle>
<label for=section-3e279b5e02791c6f975beaf42ab8da60 class="flex justify-between"><a role=button>并发组件</a></label><ul><li><a href=/zh-cn/docs/java/concurrency/components/9_1_countdownlatch/>CountDownLatch</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_2_cyclicbarrier/>CyclicBarrier</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_3_semaphore/>Semaphore</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_4_exchanger/>Exchanger</a></li><li><a href=/zh-cn/docs/java/concurrency/components/9_5_priorityblockqueue_delayqueue/>PriorityBlockingQueue and DelayQueue</a></li></ul></li></ul></li><li><input type=checkbox id=section-3bd094917595c7b08e12213b93b8f0f5 class=toggle>
<label for=section-3bd094917595c7b08e12213b93b8f0f5 class="flex justify-between"><a role=button>JVM</a></label><ul><li><a href=/zh-cn/docs/java/jvm/Java%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E8%AF%A6%E8%A7%A3/>Java内存区域详解(转)</a></li><li><a href=/zh-cn/docs/java/jvm/java-gc/>JVM垃圾回收概要(转)</a></li><li><a href=/zh-cn/docs/java/jvm/10_Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8Evolatile%E5%85%B3%E9%94%AE%E5%AD%97/>JMM与volatile关键字(转)</a></li></ul></li></ul></li><li class=book-section-flat><span>Design Pattern</span><ul><li><input type=checkbox id=section-38f2a4dc1224a3f63cb15f52b157f80c class=toggle>
<label for=section-38f2a4dc1224a3f63cb15f52b157f80c class="flex justify-between"><a role=button>Creation</a></label><ul><li><a href=/zh-cn/docs/design_pattern/creation/20240328_singleton/>单例模式</a></li><li><a href=/zh-cn/docs/design_pattern/creation/20240326_factory/>工厂模式</a></li><li><a href=/zh-cn/docs/design_pattern/creation/20240326_abstract_factory/>抽象工厂模式</a></li><li><a href=/zh-cn/docs/design_pattern/creation/20240313_builder/>建造者模式</a></li></ul></li><li><input type=checkbox id=section-2916cf7825614f6c5714a12668976218 class=toggle>
<label for=section-2916cf7825614f6c5714a12668976218 class="flex justify-between"><a role=button>Behaviour</a></label><ul><li><a href=/zh-cn/docs/design_pattern/behaviour/20240329_command/>命令模式</a></li><li><a href=/zh-cn/docs/design_pattern/behaviour/20240308_observer/>观察者模式</a></li><li><a href=/zh-cn/docs/design_pattern/behaviour/20240307_strategy/>策略模式</a></li><li><a href=/zh-cn/docs/design_pattern/behaviour/20240402_template_method/>模板方法模式</a></li></ul></li><li><input type=checkbox id=section-b9c02f715df93d0c0f9aac2c7959042e class=toggle>
<label for=section-b9c02f715df93d0c0f9aac2c7959042e class="flex justify-between"><a role=button>Structural</a></label><ul><li><a href=/zh-cn/docs/design_pattern/structure/20240321_decorator/>装饰者模式</a></li><li><a href=/zh-cn/docs/design_pattern/structure/20240401_adaptor/>适配器模式</a></li><li><a href=/zh-cn/docs/design_pattern/structure/20240401_%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/>外观模式</a></li><li><a href=/zh-cn/docs/design_pattern/structure/20181205_proxy/>代理模式</a></li></ul></li></ul></li><li class=book-section-flat><span>Note</span><ul><li><input type=checkbox id=section-e244588c8ce424aa1cf15d199f1ef0e3 class=toggle>
<label for=section-e244588c8ce424aa1cf15d199f1ef0e3 class="flex justify-between"><a href=/zh-cn/docs/note/operating_system_peking/>操作系统原理</a></label><ul><li><a href=/zh-cn/docs/note/operating_system_peking/1_intro/>引论</a></li><li><a href=/zh-cn/docs/note/operating_system_peking/2_env_and_logic/>操作系统运行环境与机制</a></li><li><a href=/zh-cn/docs/note/operating_system_peking/3_processes_and_threads/>进程和线程模型</a></li></ul></li><li><input type=checkbox id=section-a89519ae3821a3361de4402069b7400c class=toggle>
<label for=section-a89519ae3821a3361de4402069b7400c class="flex justify-between"><a href=/zh-cn/docs/note/algorithms_part1/>算法-第一部分</a></label><ul></ul></li></ul></li><li class=book-section-flat><span>Snippets</span><ul><li><input type=checkbox id=section-dd52bdbe9ac4751ef3dcf3461e80649d class=toggle>
<label for=section-dd52bdbe9ac4751ef3dcf3461e80649d class="flex justify-between"><a role=button>Java</a></label><ul><li><a href=/zh-cn/docs/snippets/java/Gfunction/>Java接口作为方法入参</a></li><li><a href=/zh-cn/docs/snippets/java/Goto/>Java中使用goto语句？</a></li><li><a href=/zh-cn/docs/snippets/java/ImmutableStr/>Java字符串的不可变</a></li><li><a href=/zh-cn/docs/snippets/java/MainClass/>子类不能调用父类中定义的构造器来实例化</a></li><li><a href=/zh-cn/docs/snippets/java/StaticBlock/>静态代码块的行为</a></li><li><a href=/zh-cn/docs/snippets/java/Threading/>线程竞争</a></li><li><a href=/zh-cn/docs/snippets/java/TryF/>不要在finally块中返回值</a></li></ul></li><li><input type=checkbox id=section-8e86454c83f21433a52f142ad9bf5b57 class=toggle>
<label for=section-8e86454c83f21433a52f142ad9bf5b57 class="flex justify-between"><a role=button>Python</a></label><ul><li><input type=checkbox id=section-5a39b63c2f73603c10d31897dff8e759 class=toggle>
<label for=section-5a39b63c2f73603c10d31897dff8e759 class="flex justify-between"><a role=button>基本概念</a></label><ul><li><a href=/zh-cn/docs/snippets/pys/intro/1_flow_control/>流程控制语句</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/2_data_list/>列表（list）</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/3_data_str/>字符串，元组和字典</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/4_func/>函数式编程</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/4_important_funcs/>4个重要的内置函数</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/5_file_io/>格式化输出与文件I/O</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/6_try_excep/>异常处理</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/7_scope/>命名空间与作用域</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/8_class_type/>类与对象</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/9_decoration/>闭包与装饰器</a></li><li><a href=/zh-cn/docs/snippets/pys/intro/10_decoration_2/>装饰器2</a></li></ul></li><li><input type=checkbox id=section-8a2ade9bb18f622d5ede552ec13316cb class=toggle>
<label for=section-8a2ade9bb18f622d5ede552ec13316cb class="flex justify-between"><a role=button>线程模型</a></label><ul><li><a href=/zh-cn/docs/snippets/pys/threading/11_threading/>初窥Python线程</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/12_threading_lock/>线程-锁</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/13_threading_condition/>线程-条件</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/14_threading_semaphore/>线程-信号量</a></li><li><a href=/zh-cn/docs/snippets/pys/threading/15_threading_event/>线程-事件</a></li></ul></li></ul></li><li><input type=checkbox id=section-6c0052d68c843d8c1b215d5a7052aac5 class=toggle>
<label for=section-6c0052d68c843d8c1b215d5a7052aac5 class="flex justify-between"><a role=button>Gist</a></label><ul><li><a href=/zh-cn/docs/snippets/gist/clash_pro/>Clash Pro代理手动配置示例</a></li></ul></li></ul></li></ul><ul><li><a href=/zh-cn/posts/>Blog</a></li><li><a href=/zh-cn/archive/>Archive</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Java8日期和时间API</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><div id=toc-new><ul class=nav><li class=nav-item><a id=t1前言 href=javascript:void(0) onclick='return scrolly("1-前言"),!1'>1 前言</a></li><li class=nav-item><a id=t2概览 href=javascript:void(0) onclick='return scrolly("2-概览"),!1'>2 概览</a></li><li class=nav-item><a id=t3javatime优点 href=javascript:void(0) onclick='return scrolly("3-javatime优点"),!1'>3 java.time优点</a><ul class=nav><li class=nav-item><a id=t31设计 href=javascript:void(0) onclick='return scrolly("31-设计"),!1'>3.1 设计</a></li><li class=nav-item><a id=t32命名 href=javascript:void(0) onclick='return scrolly("32-命名"),!1'>3.2 命名</a></li><li class=nav-item><a id=t33合理的接口设计 href=javascript:void(0) onclick='return scrolly("33-合理的接口设计"),!1'>3.3 合理的接口设计</a></li></ul></li><li class=nav-item><a id=t4javatime使用示例 href=javascript:void(0) onclick='return scrolly("4-javatime使用示例"),!1'>4 java.time使用示例</a></li><li class=nav-item><a id=t5补充内容 href=javascript:void(0) onclick='return scrolly("5-补充内容"),!1'>5 补充内容</a><ul class=nav><li class=nav-item><a id=t51时区 href=javascript:void(0) onclick='return scrolly("51-时区"),!1'>5.1 时区</a></li><li class=nav-item><a id=t52子午线 href=javascript:void(0) onclick='return scrolly("52-子午线"),!1'>5.2 子午线</a></li><li class=nav-item><a id=t53本初子午线 href=javascript:void(0) onclick='return scrolly("53-本初子午线"),!1'>5.3 本初子午线</a></li><li class=nav-item><a id=t54国际标准ISO8601 href=javascript:void(0) onclick='return scrolly("54-国际标准iso-8601"),!1'>5.4 国际标准ISO 8601</a></li><li class=nav-item><a id=t55协调世界时 href=javascript:void(0) onclick='return scrolly("55-协调世界时"),!1'>5.5 协调世界时</a></li><li class=nav-item><a id=t56UTC偏移量 href=javascript:void(0) onclick='return scrolly("56-utc偏移量"),!1'>5.6 UTC偏移量</a></li><li class=nav-item><a id=t57格林尼治平时 href=javascript:void(0) onclick='return scrolly("57-格林尼治平时"),!1'>5.7 格林尼治平时</a></li></ul></li><li class=nav-item><a id=t6参考 href=javascript:void(0) onclick='return scrolly("6-参考"),!1'>6 参考</a></li></ul></div><script>function scrolly(e){const t=40;var n=document.getElementById(e).offsetTop;window.scrollTo({top:n+t,behaviour:"smooth"})}</script></aside></header><article class="markdown book-post"><h1>Java8日期和时间API</h1><div class="postmeta flex align-cneter" style=justify-content:center><div class="created flex align-cneter"><img src=/svg/calendar-event.svg class=book-icon alt>
<a title='创建者 wangy325'>2021-02-02</a></div><div class="cates flex align-center"><img src=/svg/cates.svg class=book-icon alt>
<a href=/zh-cn/categories/java/>Java</a></div><div class="last-modified flex align center"><img src=/svg/edit.svg class=book-icon alt>
<a title='最后修改者 wangy325-win | 2025-03-02'>2025-03-02</a></div></div><blockquote><p>mybatis自 3.4.5 开始，已经支持使用<code>LocaldateTime</code>作为时间查询入参，映射类型为<code>TimeStamp</code>，参考地址:
<a href=https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers>https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers</a></p></blockquote><h1 id=1-前言>1 前言
<a class=anchor href=#1-%e5%89%8d%e8%a8%80>#</a></h1><p>在介绍Java SE 8中新的日期时间库前，先了解下Java 8之前的日期时间工具的诟病。</p><p>在Java SE 8前，日期时间工具库在<code>java.util</code>包中，包括：</p><ul><li><code>java.util.Date</code>：表示日期和时间</li><li><code>java.util.Calendar</code>以及其实现子类：表示各种日历系统，常用的是格林威治日历<code>java.util.GregorianCalendar</code></li><li><code>java.util.TimeZone</code>以及其实现子类：表示时区偏移量和夏令时</li></ul><p>以及辅助其进行格式化和解析的工具库在java.text包中，包括：</p><ul><li><code>java.text.DateFormat</code>：格式化日期时间和解析日期时间的工具抽象类</li><li><code>java.text.SimpleDateFormat</code>：DateDateFormat的实现</li></ul><p>从以上的简述中，对java 8之前的日期时间库，有所宏观视觉。下面简要总结下其设计上的瑕疵和被开发者无限吐槽的诟病：</p><ul><li>从以上的api上看，java 8之前的日期时间工具库缺乏年、月、日、时间、星期的单独抽象；</li><li><code>Date</code>日期时间类既描述日期又描述时间，耦合，且<code>Date</code>不仅在<code>java.util</code>包中存在，在<code>java.sql</code>中也存在，重复名称，容易导致bug发生；</li><li>api的设计上晦涩，难用，不够生动，难以以自然人类的思维理解日期时间。年月日需要从<code>Calendar</code>中获取；</li><li>最被开发者抱怨的是<strong>类型不安全</strong>，<code>Calendar</code>类中全局属性是可变的，在多线程访问时，会存在线程安全问题。<code>SimpleDateFormat</code>格式化和解析日期，需要使用年月日时分秒，所以持有了<code>Calendar</code>属性，<strong>导致其也是非线程安全</strong>；</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln> 1</span><span class=cl><span class=c1>// 以下都是Calendar中持有的全局属性</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=c1>// 这些全局属性都是可变的，提供了set</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=kd>protected</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>fields</span><span class=o>[]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w></span><span class=kd>transient</span><span class=w> </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>stamp</span><span class=o>[]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w></span><span class=kd>protected</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>time</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=kd>protected</span><span class=w> </span><span class=kt>boolean</span><span class=w>  </span><span class=n>isTimeSet</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w></span><span class=c1>// 在其子类GregorianCalendar中</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=kd>transient</span><span class=w> </span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>zoneOffsets</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w></span><span class=c1>// setTime方法会调用此方法</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w></span><span class=c1>// 该方法中修改了上述的很多全局属性</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>setTimeInMillis</span><span class=p>(</span><span class=kt>long</span><span class=w> </span><span class=n>millis</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=c1>// If we don&#39;t need to recalculate the calendar field values,</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>        </span><span class=c1>// do nothing.</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>time</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>millis</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>isTimeSet</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>areFieldsSet</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>areAllFieldsSet</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>            </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>zone</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>ZoneInfo</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=p>((</span><span class=n>ZoneInfo</span><span class=p>)</span><span class=n>zone</span><span class=p>).</span><span class=na>isDirty</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>        </span><span class=n>time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>millis</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>        </span><span class=n>isTimeSet</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>        </span><span class=n>areFieldsSet</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>        </span><span class=n>computeFields</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=w>        </span><span class=n>areAllFieldsSet</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>areFieldsSet</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>所以在多线程环境中使用<code>Calendar</code>是非线程安全的 ，多个线程修改其属性域会导致<strong>数据一致性和可见性</strong>问题。</p><p>在<code>DateFormat</code>中持有了<code>Calendar</code>属性，用于解析和格式化日期：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln> 1</span><span class=cl><span class=c1>// 从注释上看，Calendar用于计算日期时间域</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=cm>/**
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=cm> * The {@link Calendar} instance used for calculating the date-time fields
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=cm> * and the instant of time. This field is used for both formatting and
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=cm> * parsing.
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=cm> * &lt;p&gt;Subclasses should initialize this field to a {@link Calendar}
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=cm> * appropriate for the {@link Locale} associated with this
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=cm> * &lt;code&gt;DateFormat&lt;/code&gt;.
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=cm> * @serial
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=cm> */</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w></span><span class=kd>protected</span><span class=w> </span><span class=n>Calendar</span><span class=w> </span><span class=n>calendar</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w></span><span class=c1>// Called from Format after creating a FieldDelegate</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=n>StringBuffer</span><span class=w> </span><span class=nf>format</span><span class=p>(</span><span class=n>Date</span><span class=w> </span><span class=n>date</span><span class=p>,</span><span class=w> </span><span class=n>StringBuffer</span><span class=w> </span><span class=n>toAppendTo</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>                            </span><span class=n>FieldDelegate</span><span class=w> </span><span class=n>delegate</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>    </span><span class=c1>// Convert input date to time field list</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>    </span><span class=n>calendar</span><span class=p>.</span><span class=na>setTime</span><span class=p>(</span><span class=n>date</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>    </span><span class=kt>boolean</span><span class=w> </span><span class=n>useDateFormatSymbols</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>useDateFormatSymbols</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>compiledPattern</span><span class=p>.</span><span class=na>length</span><span class=p>;</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>tag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>compiledPattern</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=w> </span><span class=o>&gt;&gt;&gt;</span><span class=w> </span><span class=n>8</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>compiledPattern</span><span class=o>[</span><span class=n>i</span><span class=o>++]</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=n>0xff</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>count</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>255</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=w>            </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>compiledPattern</span><span class=o>[</span><span class=n>i</span><span class=o>++]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>16</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=w>            </span><span class=n>count</span><span class=w> </span><span class=o>|=</span><span class=w> </span><span class=n>compiledPattern</span><span class=o>[</span><span class=n>i</span><span class=o>++]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=w>        </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>tag</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>31</span><span class=cl><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=n>TAG_QUOTE_ASCII_CHAR</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=w>            </span><span class=n>toAppendTo</span><span class=p>.</span><span class=na>append</span><span class=p>((</span><span class=kt>char</span><span class=p>)</span><span class=n>count</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=n>TAG_QUOTE_CHARS</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=w>            </span><span class=n>toAppendTo</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>compiledPattern</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>37</span><span class=cl><span class=w>            </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>count</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>38</span><span class=cl><span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>39</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>40</span><span class=cl><span class=w>        </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>41</span><span class=cl><span class=w>            </span><span class=n>subFormat</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>,</span><span class=w> </span><span class=n>delegate</span><span class=p>,</span><span class=w> </span><span class=n>toAppendTo</span><span class=p>,</span><span class=w> </span><span class=n>useDateFormatSymbols</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>42</span><span class=cl><span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>43</span><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>44</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>45</span><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>toAppendTo</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>46</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><code>format</code>方法中设置了全局成员<code>Calendar</code>的time，多线程访问时每次都会改变Calendar类，导致format格式化时会出现线程安全问题。所以<code>DateFormat</code>和其子类<code>SimpleDateFormat</code>都是<strong>非类型安全</strong>。</p><p>这个可以说是被开发者极度抱怨的。所以<strong>在使用日期格式工具时大多数都会重新new或者使用ThreadLocal</strong>。</p><p>基于此诸多问题，java设计者终于在Java SE 8中引入了新的日期时间库。新的日期时间库的易用程度会让你振服！下面开始进入主题，Java SE 8中的日期时间库<code>java.time</code>。</p><h1 id=2-概览>2 概览
<a class=anchor href=#2-%e6%a6%82%e8%a7%88>#</a></h1><p>先认识下
<a href=https://www.joda.org>joda</a>项目，joda项目包括：</p><ul><li><strong>Joda-Time - Basic types for Date and Time</strong></li><li>Joda-Money - Basic types for Money</li><li>Joda-Beans - Next generation JavaBeans</li><li>Joda-Convert - String to Object conversion</li><li>Joda-Collect - Additional collection data structures</li></ul><p>其中<code>Joda-Time</code>是日期时间三方库，但是在java 8之前，joda time其实是标准的日期时间库，其出色的语义表达，易用易于理解的api，类型安全的特性，大受开发者的追捧。而且其日历系统遵循的是
<a href=https://zh.wikipedia.org/wiki/ISO_8601#%E6%97%A5%E5%8E%86%E6%97%A5%E6%9C%9F%E8%A1%A8%E7%A4%BA%E6%B3%95>IOS_8601</a>国际标准，同时还包括其他的非标准的日历系统。支持时区、持续时间、格式化和解析功能。</p><p>在java 8之前可以依赖joda time三方库，使用其日期时间库。</p><p>但在java 8中提出了
<a href=https://jcp.org/aboutJava/communityprocess/pfd/jsr310/JSR-310-guide.html>JSR 310</a>: Date and Time API规范，该规范即新版的日期时间库<code>java.time</code>规约。可以说JSR-310的设计上汲取了大量的joda time的特性。新版本的日期时间库基于JSR 310: Date and Time API开发，<code>java.time</code>是基于国际化标准日历系统（International Organization for Standardization）ISO_8601，同时<code>java.time.chrono</code>支持对全球日历系统的扩展。</p><p>JSR-310中设计的<code>java.time</code>包括年、月、星期、日期时间、持续时间段、瞬时、时钟、时区的抽象及处理。且api的设计上使用易读易于理解的名称和设计模式，让使用者欣然接受。而且提供旧版和新版api之间的互通以处理兼容性问题。</p><p>下面看张概览图，从宏观角度了解下<code>java.time</code></p><center style=font-size:.8rem;color:grey;font-style:italic><p><img src=/img/java8-time.png alt=img></p><p>Java 8的新时间日期API</center><ul><li>第一层是对年、月、月中日、星期的抽象；</li><li>第二层是对日期、日期时间、时区的抽象，其中时区分为时区Id（Europe/Paris）和时区偏移量(Z/+hh:mm/-hh:mm)；</li><li>第三层是对区域时间和便宜时间的抽象；</li><li>第四层是对瞬时和时钟的抽象；</li><li>第五层是对时序时段和持续周期的抽象</li><li>右侧层是辅助工具类，如：日期时间格式、日期时间调整器、其他的日历系统；</li></ul><p>java 8中日期时间库共分为五个package：</p><ul><li><code>java.time</code>：基于ISO_8601日历系统实现的日期时间库</li><li><code>java.time.chrono</code>：全球日历系统扩展库，可以自行扩展</li><li><code>java.time.format</code>：日期时间格式，包含大量预定义的格式，可以自行扩展</li><li><code>java.time.zone</code>：时区信息库</li><li><code>java.time.temporal</code>：日期时间调整辅助库</li></ul><p>关于日期时间库的使用详细过程，推荐查看oracle提供的java教程
<a href=https://docs.oracle.com/javase/tutorial/datetime/index.html>The Java™ Tutorials——Trail: Date Time</a></p><h1 id=3--javatime优点>3 java.time优点
<a class=anchor href=#3--javatime%e4%bc%98%e7%82%b9>#</a></h1><h2 id=31-设计>3.1 设计
<a class=anchor href=#31-%e8%ae%be%e8%ae%a1>#</a></h2><p><code>java.time</code>中使用了大量的设计模式：</p><ul><li><strong>工厂模式</strong>：<code>now()</code>工厂方法直接生成当前日期时间或者瞬时；<code>of()</code>工厂方法根据年月日时分秒生成日期或者日期时间；</li><li><strong>装饰模式</strong>：时区时间<code>ZoneDateTime</code>/偏移时间<code>OffsetDateTime</code>，都是在<code>LocalDateTime</code>的基础上加上时区/偏移量的修饰成为时区时间，然后可以进行时区转换；</li><li><strong>建造者模式</strong>：<code>Calendar</code>中加入建造者类，用于生成新的<code>Calendar</code>对象；</li></ul><h2 id=32-命名>3.2 命名
<a class=anchor href=#32-%e5%91%bd%e5%90%8d>#</a></h2><p>java 8中的日期时间库类名、方法名命名上都是极其形象生动，易于理解，让开发者极易于使用——语义清晰精确！如：LocalDate中提供的now表示现在的日期，of用于年月日组成的日期（这里和英文中的of意义非常贴切），plus/minus加减等等；</p><h2 id=33-合理的接口设计>3.3 合理的接口设计
<a class=anchor href=#33-%e5%90%88%e7%90%86%e7%9a%84%e6%8e%a5%e5%8f%a3%e8%ae%be%e8%ae%a1>#</a></h2><ul><li><code>LocalDate</code>表示日期，由年月日组成，提供了获取所在年，所在月，所在日的api，提供所在一年的第几天api，用于比较日期前后api，替换年份、月份、日的api，这些api使得日期或者日期时间的处理上得到的功能上的极大提升；</li><li>抽象出年、月、日、星期、日期、日期时间、瞬时、周期诸多接口，对事物本质有了细腻的抽象，并提供了相互转换的能力——提供极强的处理能力和语言表达能力；</li><li>对于遗留的日期时间库<code>Calendar/Date/Timezone</code>和新的日期时间库的互通性；</li><li>将全球的非标准日历系统单独抽象并支持扩展，从标准日历系统中隔离（符合设计原则：对修改关闭，对扩展开放）</li></ul><h1 id=4-javatime使用示例>4 java.time使用示例
<a class=anchor href=#4-javatime%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b>#</a></h1><p>得益于新日期时间框架的设计，无论是类名还是方法名以及可读性，都相当容易理解，其上手成本比Date/Calendar要低得多。</p><p>并且，LocalDateTime/LocalDate之间，以及它们和jdk 1.8之前的Date也可以互相转换。</p><p>以下是一个使用示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln>  1</span><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Intro</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>  2</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>yyyy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;yyyy&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>  3</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>yyyy_MM</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;yyy-MM&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>  4</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>yyyy_MM_dd</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;yyyy-MM-dd&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>  5</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>yyyy_MM_dd_HH_mm_ss</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>  6</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>yyyy_MM_dd_HH_mm_ss_SSS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;yyyy-MM-dd HH:mm:ss.SSS&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>  7</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>  8</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln>  9</span><span class=cl><span class=cm>     * If the pattern like &#39;yyyy&#39;, result {@link LocalDateTime} could be like &#39;yyyy-01-01 00:00:00&#39;.&lt;br&gt;
</span></span></span><span class=line><span class=ln> 10</span><span class=cl><span class=cm>     * If the pattern like &#39;yyyy-MM&#39;, result {@link LocalDateTime} could be like &#39;yyyy-MM-01 00:00:00&#39;.&lt;br&gt;
</span></span></span><span class=line><span class=ln> 11</span><span class=cl><span class=cm>     * If the pattern like &#39;yyyy-MM-dd&#39;, result {@link LocalDateTime} could be like &#39;yyyy-MM-dd 00:00:00&#39;.&lt;br&gt;
</span></span></span><span class=line><span class=ln> 12</span><span class=cl><span class=cm>     * Other patterns acts the same.
</span></span></span><span class=line><span class=ln> 13</span><span class=cl><span class=cm>     * &lt;p&gt;
</span></span></span><span class=line><span class=ln> 14</span><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=ln> 15</span><span class=cl><span class=cm>     * &lt;b&gt;Important:&lt;/b&gt; the pattern and the the {@link LocalDateTime#parse(CharSequence, DateTimeFormatter)} method&#39;s input {@link CharSequence} must match.
</span></span></span><span class=line><span class=ln> 16</span><span class=cl><span class=cm>     * e.g. The following method call will throw {@link java.time.format.DateTimeParseException}:
</span></span></span><span class=line><span class=ln> 17</span><span class=cl><span class=cm>     * &lt;pre&gt;
</span></span></span><span class=line><span class=ln> 18</span><span class=cl><span class=cm>     *      LocalDateTime localDateTime = LocalDateTime.parse(&#34;2021&#34;,dtfBuilder(&#34;yyyy-MM&#34;));
</span></span></span><span class=line><span class=ln> 19</span><span class=cl><span class=cm>     * &lt;/pre&gt;
</span></span></span><span class=line><span class=ln> 20</span><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=ln> 21</span><span class=cl><span class=cm>     * @param pattern the string pattern
</span></span></span><span class=line><span class=ln> 22</span><span class=cl><span class=cm>     * @see DateTimeFormatter javadoc
</span></span></span><span class=line><span class=ln> 23</span><span class=cl><span class=cm>     * @see LocalDateTime#parse(CharSequence, DateTimeFormatter)
</span></span></span><span class=line><span class=ln> 24</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln> 25</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>DateTimeFormatter</span><span class=w> </span><span class=nf>dtfBuilder</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>pattern</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 26</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>DateTimeFormatterBuilder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=ln> 27</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>appendPattern</span><span class=p>(</span><span class=n>pattern</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 28</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseDefaulting</span><span class=p>(</span><span class=n>ChronoField</span><span class=p>.</span><span class=na>YEAR_OF_ERA</span><span class=p>,</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>().</span><span class=na>getYear</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=ln> 29</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseDefaulting</span><span class=p>(</span><span class=n>ChronoField</span><span class=p>.</span><span class=na>MONTH_OF_YEAR</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 30</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseDefaulting</span><span class=p>(</span><span class=n>ChronoField</span><span class=p>.</span><span class=na>DAY_OF_MONTH</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 31</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseDefaulting</span><span class=p>(</span><span class=n>ChronoField</span><span class=p>.</span><span class=na>HOUR_OF_DAY</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 32</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseDefaulting</span><span class=p>(</span><span class=n>ChronoField</span><span class=p>.</span><span class=na>MINUTE_OF_HOUR</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 33</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseDefaulting</span><span class=p>(</span><span class=n>ChronoField</span><span class=p>.</span><span class=na>SECOND_OF_MINUTE</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 34</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseDefaulting</span><span class=p>(</span><span class=n>ChronoField</span><span class=p>.</span><span class=na>NANO_OF_SECOND</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln> 35</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>toFormatter</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln> 36</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln> 37</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 38</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>SimpleDateFormat</span><span class=w> </span><span class=nf>sdfBuilder</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>pattern</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 39</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SimpleDateFormat</span><span class=p>(</span><span class=n>pattern</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln> 40</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln> 41</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 42</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln> 43</span><span class=cl><span class=cm>     * solution1:
</span></span></span><span class=line><span class=ln> 44</span><span class=cl><span class=cm>     * Get yyyy-MM-dd 00:00:00, start of the day.&lt;br&gt;
</span></span></span><span class=line><span class=ln> 45</span><span class=cl><span class=cm>     * If you use yyyy-MM-dd as parameter
</span></span></span><span class=line><span class=ln> 46</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln> 47</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getStartOfDay</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 48</span><span class=cl><span class=w>        </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;2021-02-02&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln> 49</span><span class=cl><span class=w>                </span><span class=n>dtfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=ln> 50</span><span class=cl><span class=w>        </span><span class=n>Instant</span><span class=w> </span><span class=n>instant</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDateTime</span><span class=p>.</span><span class=na>atZone</span><span class=p>(</span><span class=n>ZoneId</span><span class=p>.</span><span class=na>systemDefault</span><span class=p>()).</span><span class=na>toInstant</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln> 51</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Date</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>instant</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln> 52</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln> 53</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 54</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln> 55</span><span class=cl><span class=cm>     * solution2:
</span></span></span><span class=line><span class=ln> 56</span><span class=cl><span class=cm>     * get yyyy-MM-dd 00:00:00, start of the day.&lt;br&gt;
</span></span></span><span class=line><span class=ln> 57</span><span class=cl><span class=cm>     * If you use yyyy-MM-dd as parameter&lt;br&gt;
</span></span></span><span class=line><span class=ln> 58</span><span class=cl><span class=cm>     * &lt;p&gt;
</span></span></span><span class=line><span class=ln> 59</span><span class=cl><span class=cm>     * Using {@link LocalDate#atStartOfDay()}
</span></span></span><span class=line><span class=ln> 60</span><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=ln> 61</span><span class=cl><span class=cm>     * @param dateString datePattern like 2012-09-08
</span></span></span><span class=line><span class=ln> 62</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln> 63</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getStartOfDay</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>dateString</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>ParseException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 64</span><span class=cl><span class=w>        </span><span class=c1>//由于dtfBuilder的设置 这里的时间已经是 00:00:00</span><span class=w>
</span></span></span><span class=line><span class=ln> 65</span><span class=cl><span class=w>        </span><span class=n>LocalDate</span><span class=w> </span><span class=n>localDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDate</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=n>dateString</span><span class=p>,</span><span class=w> </span><span class=n>dtfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=ln> 66</span><span class=cl><span class=w>        </span><span class=n>ZonedDateTime</span><span class=w> </span><span class=n>zonedDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDate</span><span class=p>.</span><span class=na>atStartOfDay</span><span class=p>(</span><span class=n>ZoneId</span><span class=p>.</span><span class=na>systemDefault</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln> 67</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Date</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>zonedDateTime</span><span class=p>.</span><span class=na>toInstant</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln> 68</span><span class=cl><span class=w></span><span class=c1>//        return sdfBuilder().parse(zonedDateTime.format(dtfBuilder(yyyy_MM_dd_HH_mm_ss)));</span><span class=w>
</span></span></span><span class=line><span class=ln> 69</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln> 70</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 71</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln> 72</span><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=ln> 73</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln> 74</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getStartOfDay</span><span class=p>(</span><span class=n>LocalDate</span><span class=w> </span><span class=n>localDate</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=ln> 75</span><span class=cl><span class=w>        </span><span class=n>ZonedDateTime</span><span class=w> </span><span class=n>zonedDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDate</span><span class=p>.</span><span class=na>atStartOfDay</span><span class=p>(</span><span class=n>ZoneId</span><span class=p>.</span><span class=na>systemDefault</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln> 76</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 77</span><span class=cl><span class=w>        </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDate</span><span class=p>.</span><span class=na>atStartOfDay</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln> 78</span><span class=cl><span class=w>        </span><span class=n>Instant</span><span class=w> </span><span class=n>instant</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDateTime</span><span class=p>.</span><span class=na>toInstant</span><span class=p>(</span><span class=n>ZoneOffset</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=s>&#34;+8&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=ln> 79</span><span class=cl><span class=w></span><span class=c1>//        return Date.from(zonedDateTime.toInstant());</span><span class=w>
</span></span></span><span class=line><span class=ln> 80</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Date</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>instant</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln> 81</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln> 82</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 83</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln> 84</span><span class=cl><span class=cm>     * Get yyyy-MM-dd 23:59:59.999, end of the day.&lt;br&gt;
</span></span></span><span class=line><span class=ln> 85</span><span class=cl><span class=cm>     * By using {@link LocalDateTime#plus(long, TemporalUnit)}
</span></span></span><span class=line><span class=ln> 86</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln> 87</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getEndOfDay</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 88</span><span class=cl><span class=w>        </span><span class=c1>//由于dtfBuilder的设置 这里的时间已经是 00:00:00</span><span class=w>
</span></span></span><span class=line><span class=ln> 89</span><span class=cl><span class=w>        </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;2020-12-21&#34;</span><span class=p>,</span><span class=w> </span><span class=n>dtfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=ln> 90</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 91</span><span class=cl><span class=w>        </span><span class=c1>//plusXxx()方法没有提供毫秒/微秒的相应方法，直接到纳秒； 相应的，可以使用plus方法指定单位</span><span class=w>
</span></span></span><span class=line><span class=ln> 92</span><span class=cl><span class=w>        </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDateTime</span><span class=p>.</span><span class=na>plusHours</span><span class=p>(</span><span class=n>23</span><span class=p>).</span><span class=na>plusMinutes</span><span class=p>(</span><span class=n>59</span><span class=p>).</span><span class=na>plusSeconds</span><span class=p>(</span><span class=n>59</span><span class=p>).</span><span class=na>plusNanos</span><span class=p>(</span><span class=n>999_999_999</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln> 93</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 94</span><span class=cl><span class=w>        </span><span class=cm>/*
</span></span></span><span class=line><span class=ln> 95</span><span class=cl><span class=cm>         *  好方法，将其下级单位的值清零
</span></span></span><span class=line><span class=ln> 96</span><span class=cl><span class=cm>         *  ChronoUnit.DAYS: 清零hh:mm:ss.SSS
</span></span></span><span class=line><span class=ln> 97</span><span class=cl><span class=cm>         *  最大单位 DAYS，也就是说此方法只能用来清零时间
</span></span></span><span class=line><span class=ln> 98</span><span class=cl><span class=cm>         */</span><span class=w>
</span></span></span><span class=line><span class=ln> 99</span><span class=cl><span class=w>        </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDateTime</span><span class=p>.</span><span class=na>truncatedTo</span><span class=p>(</span><span class=n>ChronoUnit</span><span class=p>.</span><span class=na>DAYS</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>100</span><span class=cl><span class=w>        </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDateTime</span><span class=w>
</span></span></span><span class=line><span class=ln>101</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>plus</span><span class=p>(</span><span class=n>23</span><span class=p>,</span><span class=w> </span><span class=n>ChronoUnit</span><span class=p>.</span><span class=na>HOURS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>102</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>plus</span><span class=p>(</span><span class=n>59</span><span class=p>,</span><span class=w> </span><span class=n>ChronoUnit</span><span class=p>.</span><span class=na>MINUTES</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>103</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>plus</span><span class=p>(</span><span class=n>59</span><span class=p>,</span><span class=w> </span><span class=n>ChronoUnit</span><span class=p>.</span><span class=na>SECONDS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>104</span><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>plus</span><span class=p>(</span><span class=n>999</span><span class=p>,</span><span class=w> </span><span class=n>ChronoUnit</span><span class=p>.</span><span class=na>MILLIS</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>105</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Date</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>localDateTime</span><span class=p>.</span><span class=na>atZone</span><span class=p>(</span><span class=n>ZoneId</span><span class=p>.</span><span class=na>systemDefault</span><span class=p>()).</span><span class=na>toInstant</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln>106</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>107</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>108</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln>109</span><span class=cl><span class=cm>     * Get yyyy-MM-dd 23:59:59.999, end of the day.&lt;br&gt;
</span></span></span><span class=line><span class=ln>110</span><span class=cl><span class=cm>     * By using {@link LocalDate#atTime(LocalTime)}
</span></span></span><span class=line><span class=ln>111</span><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=ln>112</span><span class=cl><span class=cm>     * @param dateString date pattern like &#39;2012-09-18&#39;
</span></span></span><span class=line><span class=ln>113</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln>114</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getEndOfDay</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>dateString</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>115</span><span class=cl><span class=w>        </span><span class=n>LocalDate</span><span class=w> </span><span class=n>localDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDate</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=n>dateString</span><span class=p>,</span><span class=w> </span><span class=n>dtfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=ln>116</span><span class=cl><span class=w></span><span class=c1>//        localDate.</span><span class=w>
</span></span></span><span class=line><span class=ln>117</span><span class=cl><span class=w>        </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDate</span><span class=p>.</span><span class=na>atTime</span><span class=p>(</span><span class=n>23</span><span class=p>,</span><span class=w> </span><span class=n>59</span><span class=p>,</span><span class=w> </span><span class=n>59</span><span class=p>,</span><span class=w> </span><span class=n>999_999_999</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>118</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Date</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>localDateTime</span><span class=p>.</span><span class=na>atZone</span><span class=p>(</span><span class=n>ZoneId</span><span class=p>.</span><span class=na>systemDefault</span><span class=p>()).</span><span class=na>toInstant</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln>119</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>120</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>121</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>122</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln>123</span><span class=cl><span class=cm>     * Get first day of month
</span></span></span><span class=line><span class=ln>124</span><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=ln>125</span><span class=cl><span class=cm>     * @param dateString pattern like &#39;2020-10-25&#39;
</span></span></span><span class=line><span class=ln>126</span><span class=cl><span class=cm>     * @return
</span></span></span><span class=line><span class=ln>127</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln>128</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getFirstDayOfMonth</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>dateString</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>129</span><span class=cl><span class=w>        </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=n>dateString</span><span class=p>,</span><span class=w> </span><span class=n>dtfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=ln>130</span><span class=cl><span class=w>        </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>localDateTime</span><span class=p>.</span><span class=na>withDayOfMonth</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>131</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Date</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>localDateTime</span><span class=p>.</span><span class=na>atZone</span><span class=p>(</span><span class=n>ZoneId</span><span class=p>.</span><span class=na>systemDefault</span><span class=p>()).</span><span class=na>toInstant</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln>132</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>133</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>134</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln>135</span><span class=cl><span class=cm>     * Get the first day of year.
</span></span></span><span class=line><span class=ln>136</span><span class=cl><span class=cm>     *
</span></span></span><span class=line><span class=ln>137</span><span class=cl><span class=cm>     * @param yearString pattern like &#39;2012&#39;
</span></span></span><span class=line><span class=ln>138</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln>139</span><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>getFirstDayOfYear</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>yearString</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>140</span><span class=cl><span class=w>        </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>localDateTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=n>yearString</span><span class=p>,</span><span class=w> </span><span class=n>dtfBuilder</span><span class=p>(</span><span class=n>yyyy</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=ln>141</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Date</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>localDateTime</span><span class=p>.</span><span class=na>atZone</span><span class=p>(</span><span class=n>ZoneId</span><span class=p>.</span><span class=na>systemDefault</span><span class=p>()).</span><span class=na>toInstant</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln>142</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>143</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>144</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>145</span><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>ParseException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>146</span><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sdfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd_HH_mm_ss</span><span class=p>).</span><span class=na>format</span><span class=p>(</span><span class=n>getStartOfDay</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=ln>147</span><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sdfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd_HH_mm_ss</span><span class=p>).</span><span class=na>format</span><span class=p>(</span><span class=n>getStartOfDay</span><span class=p>(</span><span class=s>&#34;2021-02-02&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=ln>148</span><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sdfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd_HH_mm_ss_SSS</span><span class=p>).</span><span class=na>format</span><span class=p>(</span><span class=n>getStartOfDay</span><span class=p>(</span><span class=n>LocalDate</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&#34;2021-02-22&#34;</span><span class=p>,</span><span class=w> </span><span class=n>dtfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd</span><span class=p>)))));</span><span class=w>
</span></span></span><span class=line><span class=ln>149</span><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sdfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd_HH_mm_ss_SSS</span><span class=p>).</span><span class=na>format</span><span class=p>(</span><span class=n>getEndOfDay</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=ln>150</span><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sdfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd_HH_mm_ss_SSS</span><span class=p>).</span><span class=na>format</span><span class=p>(</span><span class=n>getEndOfDay</span><span class=p>(</span><span class=s>&#34;2020-12-21&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=ln>151</span><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sdfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd</span><span class=p>).</span><span class=na>format</span><span class=p>(</span><span class=n>getFirstDayOfMonth</span><span class=p>(</span><span class=s>&#34;2020-12-18&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=ln>152</span><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sdfBuilder</span><span class=p>(</span><span class=n>yyyy_MM_dd_HH_mm_ss</span><span class=p>).</span><span class=na>format</span><span class=p>(</span><span class=n>getFirstDayOfYear</span><span class=p>(</span><span class=s>&#34;2012&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=ln>153</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>154</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>源码地址：https://github.com/wangy325/java-review/blob/master/src/main/java/com/wangy/common/time/Intro.java</p><h1 id=5-补充内容>5 补充内容
<a class=anchor href=#5-%e8%a1%a5%e5%85%85%e5%86%85%e5%ae%b9>#</a></h1><h2 id=51-时区>5.1 时区
<a class=anchor href=#51-%e6%97%b6%e5%8c%ba>#</a></h2><p>时区是地球上的区域使用同一个时间定义。以前，人们通过观察太阳的位置（时角）决定时间，这就使得不同经度的地方的时间有所不同（地方时）。1863年，首次使用时区的概念。时区通过设立一个区域的标准时间部分地解决了这个问题。</p><p>世界各个国家位于地球不同位置上，因此不同国家，特别是东西跨度大的国家日出、日落时间必定有所偏差。这些偏差就是所谓的时差。</p><p>理论时区以被15整除的子午线为中心，向东西两侧延伸7.5度，即每15°划分一个时区，这是<strong>理论时区</strong>。理论时区的时间采用其中央经线（或标准经线）的地方时。所以每差一个时区，区时相差一个小时，相差多少个时区，就相差多少个小时。东边的时区时间比西边的时区时间早。为了避免日期的紊乱，提出<strong>国际日期变更线</strong>的概念</p><p>但是，为了避开国界线，有的时区的形状并不规则，而且比较大的国家以国家内部行政分界线为时区界线，这是<strong>实际时区</strong>，即法定时区。请参见
<a href=https://zh.wikipedia.org/wiki/%E6%97%B6%E5%8C%BA%E5%88%97%E8%A1%A8#UTC%EF%BC%88WET_-%E6%AD%90%E6%B4%B2%E8%A5%BF%E9%83%A8%E6%99%82%E5%8D%80%EF%BC%8CGMT-_%E6%A0%BC%E6%9E%97%E5%A8%81%E6%B2%BB%E6%A0%87%E5%87%86%E6%97%B6%E9%97%B4%EF%BC%89>时区列表</a>。</p><h2 id=52-子午线>5.2 子午线
<a class=anchor href=#52-%e5%ad%90%e5%8d%88%e7%ba%bf>#</a></h2><p>即<strong>经线</strong>，和纬线一样是人类为度量而假设出来的辅助线，定义为地球表面连接南北两极的大圆线上的半圆弧。任两根经线的长度相等，相交于南北两极点。每一根经线都有其相对应的数值，称为经度。经线指示南北方向。</p><h2 id=53-本初子午线>5.3 本初子午线
<a class=anchor href=#53-%e6%9c%ac%e5%88%9d%e5%ad%90%e5%8d%88%e7%ba%bf>#</a></h2><p>即<strong>0度经线</strong>，亦称格林尼治子午线或本初经线，是经过英国格林尼治天文台的一条经线（亦称子午线）。本初子午线的东西两边分别定为东经和西经，于180度相遇。</p><h2 id=54-国际标准iso-8601>5.4 国际标准ISO 8601
<a class=anchor href=#54-%e5%9b%bd%e9%99%85%e6%a0%87%e5%87%86iso-8601>#</a></h2><p><a href=https://zh.wikipedia.org/wiki/ISO_8601>国际标准ISO 8601</a>：是国际标准化组织的日期和时间的表示方法，全称为《数据存储和交换形式·信息交换·日期和时间的表示方法》。目前是2004年12月1日发行的第三版“ISO8601:2004”以替代1998年的第一版“ISO8601:1988”与2000年的第二版“ISO8601:2000”。</p><p>年由4位数字组成YYYY，或者带正负号的四或五位数字表示±YYYYY。以公历公元1年为0001年，以公元前1年为0000年，公元前2年为-0001年，其他以此类推。应用其他纪年法要换算成公历，但如果发送和接受信息的双方有共同一致同意的其他纪年法，可以自行应用。</p><h2 id=55-协调世界时>5.5 协调世界时
<a class=anchor href=#55-%e5%8d%8f%e8%b0%83%e4%b8%96%e7%95%8c%e6%97%b6>#</a></h2><blockquote><p>英语：Coordinated Universal Time，</p><p>法语：Temps Universel Coordonné，简称UTC</p></blockquote><p>是最主要的世界时间标准，其以原子时秒长为基础，在时刻上尽量接近于格林尼治标准时间。中华民国采用CNS 7648的《资料元及交换格式–资讯交换–日期及时间的表示法》（与ISO 8601类似）称之为世界协调时间。中华人民共和国采用ISO 8601:2000的国家标准GB/T 7408-2005《数据元和交换格式 信息交换 日期和时间表示法》中亦称之为协调世界时。</p><p>协调世界时是世界上调节时钟和时间的主要时间标准，它与0度经线的平太阳时相差不超过1秒，并不遵守夏令时。协调世界时是最接近格林威治标准时间（GMT）的几个替代时间系统之一。对于大多数用途来说，UTC时间被认为能与GMT时间互换，但GMT时间已不再被科学界所确定。</p><p>如果时间是以协调世界时（UTC）表示，则在时间后面直接加上一个“Z”（不加空格）。“Z”是协调世界时中0时区的标志。因此，“09:30 UTC”就写作“09:30Z”或是“0930Z”。“14:45:15 UTC”则为“14:45:15Z”或“144515Z”。</p><h2 id=56-utc偏移量>5.6 UTC偏移量
<a class=anchor href=#56-utc%e5%81%8f%e7%a7%bb%e9%87%8f>#</a></h2><p>UTC偏移量用以下形式表示：±[hh]:[mm]、±[hh][mm]、或者±[hh]。如果所在区时比协调世界时早1个小时（例如柏林冬季时间），那么时区标识应为“+01:00”、“+0100”或者直接写作“+01”。这也同上面的“Z”一样直接加在时间后面。
"UTC+8"表示当协调世界时（UTC）时间为凌晨2点的时候，当地的时间为2+8点，即早上10点。</p><h2 id=57-格林尼治平时>5.7 格林尼治平时
<a class=anchor href=#57-%e6%a0%bc%e6%9e%97%e5%b0%bc%e6%b2%bb%e5%b9%b3%e6%97%b6>#</a></h2><blockquote><p>英语：Greenwich Mean Time，GMT）</p></blockquote><p>是指位于英国伦敦郊区的皇家格林尼治天文台当地的平太阳时，因为本初子午线被定义为通过那里的经线。</p><p>自1924年2月5日开始，格林尼治天文台负责每隔一小时向全世界发放调时信息。</p><p>格林尼治平时的正午是指当平太阳横穿格林尼治子午线时（也就是在格林尼治上空最高点时）的时间。由于地球每天的自转是有些不规则的，而且正在缓慢减速，因此格林尼治平时基于天文观测本身的缺陷，已经被原子钟报时的协调世界时（UTC）所取代。</p><h1 id=6-参考>6 参考
<a class=anchor href=#6-%e5%8f%82%e8%80%83>#</a></h1><ul><li><a href=https://www.cnblogs.com/lxyit/p/9442135.html>Java8日期和时间工具库</a></li><li><a href=https://www.stackoverflow.com/questions/12131324/is-java-util-calendar-thread-safe-or-not>Is-java-util-calendar-thread-safe-or-no</a></li><li><a href=https://www.jianshu.com/p/19bd58b30660>Java8的java.time包</a></li><li><a href=https://www.github.com/wangy325/java-review/blob/master/src/main/java/com/wangy/common/time/Intro.java>Simp code demo of package java.time</a></li><li><a href=https://www.stackoverflow.com/questions/27454025/unable-to-obtain-localdatetime-from-temporalaccessor-when-parsing-localdatetime>Unable-to-obtain-localdatetime-from-temporalaccessor-when-parsing-localdatetime</a></li><li><a href=https://www.jcp.org/aboutJava/communityprocess/pfd/jsr310/JSR-310-guide.html>JSR 310 guide</a></li></ul></article><div class=next-prev><hr><div class="page-navi flex" id=pagenavi><div class=pre-page>←
<a href=https://wangy325.github.io/zh-cn/posts/2021/20210207_%E5%9C%A8SpringBoot%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BD%BF%E7%94%A8MockMvc%E8%BF%9B%E8%A1%8C%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/>在SpringBoot项目中使用MockMvc进行接口测试</a></div><div class=next-page><a href=https://wangy325.github.io/zh-cn/posts/2021/20210125_xxl-sharding-job/>在xxl-job中使用分片任务</a> →</div></div></div><section class=related><div class=rel-title>相似文章</div><div class=rel-items><a href=/zh-cn/posts/2021/20210125_xxl-sharding-job/ class=related__link><div>在xxl-job中使用分片任务</div></a><a href=/zh-cn/posts/2020/20201210_how2use-printf/ class=related__link><div>使用printf格式化输出</div></a><a href=/zh-cn/docs/java/jvm/Java%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E8%AF%A6%E8%A7%A3/ class=related__link><div>Java内存区域详解(转)</div></a></div><hr></section><div class=book-comments><div class=giscus-thread></div><script src=https://giscus.app/client.js data-repo=wangy325/wangy325.github.io data-repo-id=R_kgDOHhhDZg data-category=Announcements data-category-id=DIC_kwDOHhhDZs4ChbMn data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=noborder_light data-loading=lazy data-lang=zh-CN crossorigin=anonymous async></script></div><div class=copyright><hr class=cline><p>Notes and Memos by wangy325
<a href=https://creativecommons.org/licenses/by/4.0/deed.en title="Creative Commons Attribution">&copy; CC BY 4.0</a></p><p>2019-2025. Powered by
<a href=https://github.com/alex-shpak/hugo-book>Hugo Book</a>
Presented by Github.</p></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><div id=toc-new><ul class=nav><li class=nav-item><a id=t1前言 href=javascript:void(0) onclick='return scrolly("1-前言"),!1'>1 前言</a></li><li class=nav-item><a id=t2概览 href=javascript:void(0) onclick='return scrolly("2-概览"),!1'>2 概览</a></li><li class=nav-item><a id=t3javatime优点 href=javascript:void(0) onclick='return scrolly("3-javatime优点"),!1'>3 java.time优点</a><ul class=nav><li class=nav-item><a id=t31设计 href=javascript:void(0) onclick='return scrolly("31-设计"),!1'>3.1 设计</a></li><li class=nav-item><a id=t32命名 href=javascript:void(0) onclick='return scrolly("32-命名"),!1'>3.2 命名</a></li><li class=nav-item><a id=t33合理的接口设计 href=javascript:void(0) onclick='return scrolly("33-合理的接口设计"),!1'>3.3 合理的接口设计</a></li></ul></li><li class=nav-item><a id=t4javatime使用示例 href=javascript:void(0) onclick='return scrolly("4-javatime使用示例"),!1'>4 java.time使用示例</a></li><li class=nav-item><a id=t5补充内容 href=javascript:void(0) onclick='return scrolly("5-补充内容"),!1'>5 补充内容</a><ul class=nav><li class=nav-item><a id=t51时区 href=javascript:void(0) onclick='return scrolly("51-时区"),!1'>5.1 时区</a></li><li class=nav-item><a id=t52子午线 href=javascript:void(0) onclick='return scrolly("52-子午线"),!1'>5.2 子午线</a></li><li class=nav-item><a id=t53本初子午线 href=javascript:void(0) onclick='return scrolly("53-本初子午线"),!1'>5.3 本初子午线</a></li><li class=nav-item><a id=t54国际标准ISO8601 href=javascript:void(0) onclick='return scrolly("54-国际标准iso-8601"),!1'>5.4 国际标准ISO 8601</a></li><li class=nav-item><a id=t55协调世界时 href=javascript:void(0) onclick='return scrolly("55-协调世界时"),!1'>5.5 协调世界时</a></li><li class=nav-item><a id=t56UTC偏移量 href=javascript:void(0) onclick='return scrolly("56-utc偏移量"),!1'>5.6 UTC偏移量</a></li><li class=nav-item><a id=t57格林尼治平时 href=javascript:void(0) onclick='return scrolly("57-格林尼治平时"),!1'>5.7 格林尼治平时</a></li></ul></li><li class=nav-item><a id=t6参考 href=javascript:void(0) onclick='return scrolly("6-参考"),!1'>6 参考</a></li></ul></div><script>function scrolly(e){const t=40;var n=document.getElementById(e).offsetTop;window.scrollTo({top:n+t,behaviour:"smooth"})}</script></div></aside></main><div class=back-to-top><div id=back-to-top><img src=/svg/chevrons-up.svg srcset="/svg/chevrons-up.svg 500w" onclick=topFunction() class=black>
<img title=回到顶部 src=/svg/chevrons-up-blue.svg srcset="/svg/chevrons-up-blue.svg 500w" onclick=topFunction() class=blue></div><script>let mybutton=document.getElementById("back-to-top");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>500||document.documentElement.scrollTop>500?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){window.scrollTo({top:0,behavior:"smooth"})}</script></div><script src=/js/scroll-listening.js></script></body></html>
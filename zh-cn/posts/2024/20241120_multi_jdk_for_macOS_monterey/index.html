<!doctype html><html lang=zh-CN dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="记录了在macOS 12 Monterry下安装并配置多版本JDK的方法。
意外的发现brew对Monterey的支持越发的少了..."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://wangy325.github.io/zh-cn/posts/2024/20241120_multi_jdk_for_macOS_monterey/"><meta property="og:site_name" content="xf&pl"><meta property="og:title" content="在macOS monterey配置使用多版本jdk"><meta property="og:description" content="记录了在macOS 12 Monterry下安装并配置多版本JDK的方法。
意外的发现brew对Monterey的支持越发的少了..."><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-20T00:00:00+08:00"><meta property="article:modified_time" content="2025-03-05T23:17:54+08:00"><meta property="article:tag" content="软件"><title>在macOS monterey配置使用多版本jdk | xf&amp;pl</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://wangy325.github.io/zh-cn/posts/2024/20241120_multi_jdk_for_macOS_monterey/><link rel=stylesheet href=/book.min.21a480c3e6e72098579e2787d343e35263286cda9742462341e6aa278fbea46c.css integrity="sha256-IaSAw+bnIJhXnieH00PjUmMobNqXQkYjQeaqJ4++pGw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/zh-cn.search.min.c2df43b03e7a9ae96b82634fe3204a8b52c807150e1a240387fa9731a83ccbf5.js integrity="sha256-wt9DsD56mulrgmNP4yBKi1LIBxUOGiQDh/qXMag8y/U=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-HHNKR5H8KN"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HHNKR5H8KN")}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=navi-bar id=navibar><div id=page-title><h2 class=book-brand><a class="flex align-center" href=/zh-cn/><span>xf&amp;pl</span></a></h2></div><div class=page-navi-col><nav><ul><li><a href=/zh-cn/docs/java/>Java</a></li><li><a href=/zh-cn/docs/design_pattern/>DP</a></li><li class=book-section-flat><a href=/zh-cn/docs/note/>Mooc</a></li><li class=book-section-flat><a href=/zh-cn/docs/snippets/>Snippets</a></li></ul><ul><li><a href=/zh-cn/posts/>Blog</a></li><li><a href=/zh-cn/archive/>Archive</a></li></ul></nav></div><div class="book-search hidden"><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/ required pattern=\S+.*>
<span class=clear_search><img src=/svg/close.svg onclick=clearInput()></span><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><script>function clearInput(){document.getElementById("book-search-input").value="";for(var e=document.getElementById("book-search-results");e.firstChild;)e.removeChild(e.firstChild)}</script><ul class=book-languages><li><a class="flex align-center"><img src=/svg/language.svg class=book-icon alt=Languages>
简体中文</a></label><ul><li><a href=https://wangy325.github.io/en/>English</a></li></ul></li></ul></div><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>在macOS monterey配置使用多版本jdk</h3><label for=toc-control></label></div></header><article class="markdown book-post"><h1>在macOS monterey配置使用多版本jdk</h1><div class="postmeta flex align-cneter" style=justify-content:center><div class="created flex align-cneter"><img src=/svg/calendar-event.svg class=book-icon alt>
<a title='创建者 wangy325'>2024-11-20</a></div><div class="cates flex align-center"><img src=/svg/cates.svg class=book-icon alt>
<a href=/zh-cn/categories/utility/>Utility</a></div><div class="tags flex align-center"><img src=/svg/tag-alt.svg class=book-icon alt>
<a href=/zh-cn/tags/%E8%BD%AF%E4%BB%B6/>软件</a></div><div class="last-modified flex align center"><img src=/svg/edit.svg class=book-icon alt>
<a title='最后修改者 wangy325 | 2025-03-05'>2025-03-05</a></div></div><p>记录了在macOS 12 Monterry下安装并配置多版本JDK的方法。</p><p>意外的发现<code>brew</code>对Monterey的支持越发的少了...</p><blockquote class="book-hint info"><a class=hint-start>“</a><p>macOS monterey 下，<code>brew install openjdk@17</code> 和<code>brew install openjdk@8</code>均失败。</p><p>解释为brew不为旧版本的macOS提供支持。前者安装提示不具备编译jdk17的条件，后者走完进度条99%后提示不具备安装的配置文件。合着就是不给安装就是了。</p><p>我才从macOS big sur升级到monterey啊喂！</p><p>以下为报错提示：</p><blockquote><p>openjdk@17: A full installation of Xcode.app is required to compile
this software. Installing just the Command Line Tools is not sufficient.</p><p>Xcode can be installed from the App Store.
Error: openjdk@17: An unsatisfied requirement failed this build.</p></blockquote><p>实际上安装xcode之后也是同样的报错提示，无法完成安装jdk17。</p><blockquote><p>No configurations found for /private/tmp/openjdkA8-20241120-68024-ewd1kw/jdk8u-jdk8u432-ga/! Please run configure to >create a configuration.
Makefile:55: *** Cannot continue. Stop.</p></blockquote></blockquote><p>经一番调查，发现brew默认会<strong>自动更新</strong>，而brew
<a href=https://brew.sh/2024/10/01/homebrew-4.4.0/>4.3.0</a>版本之后就不再对macOS Monterey提供支持了。</p><p>但是，通过进入homebrew的文件夹<code>/usr/local/Homebrew</code>，使用<code>git checkout</code>切换到4.2.21（4.3.0之前最后一个版本），并且在<code>.zshrc</code>中配置</p><pre><code>export HOMEBREW_NO_AUTO_UPDATE=1
</code></pre><p>之后再次安装jdk，依然还是失败。</p><p>遂直接从
<a href=https://jdk.java.net/archive/>archive</a>下载指定的jdk版本，手动安装。</p><p>macOS的Java虚拟机指定安装在<code>/Library/Java/JavaVirtualMachines</code>目录下。下载后的JDK解压后，直接移动到这个文件夹即可。</p><p>以JDK17为例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=ln>1</span><span class=cl> tar xvf openjdk-17*_bin.tar.gz
</span></span></code></pre></div><p>解压后得到一个<code>jdk-17.0.2.jdk</code>文件夹，将这个文件夹的内容移动到<code>/Library/Java/JavaVirtualMachines</code>目录。</p><p>接下来，就是配置环境变量了。</p><p>以我的系统为例，目前系统里有2个jdk：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=ln>1</span><span class=cl>➜  ~ ll /Library/Java/JavaVirtualMachines
</span></span><span class=line><span class=ln>2</span><span class=cl>total <span class=m>0</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>drwxr-xr-x@ <span class=m>4</span> wangy325  staff   128B Nov <span class=m>19</span> 20:20 jdk-17.0.2.jdk
</span></span><span class=line><span class=ln>4</span><span class=cl>lrwxr-xr-x  <span class=m>1</span> root      wheel    45B Oct <span class=m>18</span>  <span class=m>2022</span> openjdk-11.jdk -&gt; /usr/local/opt/openjdk@11/libexec/openjdk.jdk
</span></span></code></pre></div><p>一个是手动安装的jdk17，一个是通过brew安装的jdk11（big sur时期）。</p><p>macOS可以通过<code>echo $(/usr/libexec/java_home -v 11)</code>来查看java的安装位置信息。后面的<code>11</code>是java的版本。</p><blockquote class="book-hint info"><a class=hint-start>“</a><p><small><em>更新于2025-03-05:</em></small></p><p><code>/usr/libexec/java_home</code>是MacOS上最简单的设置<code>JAVA_HOME</code>的方式。</p><p>通过运行<code>/usr/libexec/java_home -V</code>，可以查看当前系统所有安装的jdk版本。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=ln>1</span><span class=cl>➜  ~ /usr/libexec/java_home -V
</span></span><span class=line><span class=ln>2</span><span class=cl>Matching Java Virtual Machines (3):
</span></span><span class=line><span class=ln>3</span><span class=cl>    23.0.2 (x86_64) <span class=s2>&#34;Homebrew&#34;</span> - <span class=s2>&#34;OpenJDK 23.0.2&#34;</span> /usr/local/Cellar/openjdk/23.0.2/libexec/openjdk.jdk/Contents/Home
</span></span><span class=line><span class=ln>4</span><span class=cl>    17.0.14 (x86_64) <span class=s2>&#34;Homebrew&#34;</span> - <span class=s2>&#34;OpenJDK 17.0.14&#34;</span> /usr/local/Cellar/openjdk@17/17.0.14/libexec/openjdk.jdk/Contents/Home
</span></span><span class=line><span class=ln>5</span><span class=cl>    11.0.16.1 (x86_64) <span class=s2>&#34;Homebrew&#34;</span> - <span class=s2>&#34;OpenJDK 11.0.16.1&#34;</span> /usr/local/Cellar/openjdk@11/11.0.16.1_1/libexec/openjdk.jdk/Contents/Home
</span></span></code></pre></div><p>可以看到，所有的jdk版本都是通过<code>brew</code>安装的。是的，<strong>更新了macOS 13.7.2后，brew在MacOS上正常运行了</strong>。</p><p>同时，使用<code>/usr/libexec/java_home -v 17</code>可以查看对应版本jdk的目录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=ln>1</span><span class=cl>➜  ~ /usr/libexec/java_home -v 17
</span></span><span class=line><span class=ln>2</span><span class=cl>/usr/local/Cellar/openjdk@17/17.0.14/libexec/openjdk.jdk/Contents/Home
</span></span></code></pre></div></blockquote><p>因此，可以通过这个变量来配置环境变量。</p><p>在<code>.zshrc</code>中作以下配置：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=ln>1</span><span class=cl><span class=nb>export</span> <span class=nv>JAVA_11_HOME</span><span class=o>=</span><span class=k>$(</span>/usr/libexec/java_home -v 11<span class=k>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nb>export</span> <span class=nv>JAVA_17_HOME</span><span class=o>=</span><span class=k>$(</span>/usr/libexec/java_home -v 17<span class=k>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nb>export</span> <span class=nv>JAVA_HOME</span><span class=o>=</span><span class=nv>$JAVA_17_HOME</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:<span class=nv>$JAVA_HOME</span>/bin
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=nb>alias</span> <span class=nv>jdk11</span><span class=o>=</span><span class=s2>&#34;export JAVA_HOME=</span><span class=nv>$JAVA_11_HOME</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nb>alias</span> <span class=nv>jdk17</span><span class=o>=</span><span class=s2>&#34;export JAVA_HOME=</span><span class=nv>$JAVA_17_HOME</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>更新配置后，可以直接使用快捷命令<code>jdk11</code>和<code>jdk17</code>快速切换jdk版本。</p></article><div class=next-prev><hr><div class="page-navi flex" id=pagenavi><div class=pre-page>←
<a href=https://wangy325.github.io/zh-cn/posts/2024/20241126_HATEOAS%E5%9C%A8RESTful-API%E8%AE%BE%E8%AE%A1%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8/>在RESTful API设计中应用HATEOAS</a></div><div class=next-page><a href=https://wangy325.github.io/zh-cn/posts/2024/20241031_wsl_and_docker_engine/>Win11 WSL安装并使用docker</a> →</div></div></div><section class=related><div class=rel-title>相似文章</div><div class=rel-items><a href=/zh-cn/posts/2024/20241031_wsl_and_docker_engine/ class=related__link><div>Win11 WSL安装并使用docker</div></a><a href=/zh-cn/posts/2024/20240823_infuse%E5%85%83%E6%95%B0%E6%8D%AE/ class=related__link><div>让Infuse从TMDB正确获取元数据</div></a><a href=/zh-cn/posts/2024/20240701_get-perpetual-fallback-license-for-jetbrains-ides/ class=related__link><div>获取JetBrains IDE的永久回退授权</div></a></div><hr></section><div class=book-comments><div class=giscus-thread></div><script src=https://giscus.app/client.js data-repo=wangy325/wangy325.github.io data-repo-id=R_kgDOHhhDZg data-category=Announcements data-category-id=DIC_kwDOHhhDZs4ChbMn data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=noborder_light data-loading=lazy data-lang=zh-CN crossorigin=anonymous async></script></div><div class=copyright><hr class=cline><p>Notes and Memos by wangy325
<a href=https://creativecommons.org/licenses/by/4.0/deed.en title="Creative Commons Attribution">&copy; CC BY 4.0</a></p><p>2019-2025. Powered by
<a href=https://github.com/alex-shpak/hugo-book>Hugo Book</a>
Presented by Github.</p></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main><div class=back-to-top><div id=back-to-top><img src=/svg/chevrons-up.svg srcset="/svg/chevrons-up.svg 500w" onclick=topFunction() class=black>
<img title=回到顶部 src=/svg/chevrons-up-blue.svg srcset="/svg/chevrons-up-blue.svg 500w" onclick=topFunction() class=blue></div><script>let mybutton=document.getElementById("back-to-top");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>500||document.documentElement.scrollTop>500?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){window.scrollTo({top:0,behavior:"smooth"})}</script></div><script src=/js/scroll-listening.js></script></body></html>
<!doctype html><html lang=zh-CN dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="自己搭建了这么多年的shadowsocks服务，经历了2次续年费后服务器ip被加黑名单之后，算是彻底放弃了（心痛100刀😭），说的就是帮瓦工。vultr的服务器虽然稳定，但是延迟比较高，糟糕的时候甚至连油管的高清视频都卡顿，不过大部分时间都是轻度搜索场景，也就还能使用。那时候也知道“机场”的概念，不过自己搭的服务用着放心么不是，机场随时跑路的，就一直没用。而且vultr的服务器，5刀/月，价格也在可接受的范围内。"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://wangy325.github.io/zh-cn/posts/2024/20240615_%E4%B8%BB%E5%8A%A8%E6%89%98%E7%AE%A1Clash%E9%85%8D%E7%BD%AE/"><meta property="og:site_name" content="xf&pl"><meta property="og:title" content="主动管理Clash的代理配置"><meta property="og:description" content="自己搭建了这么多年的shadowsocks服务，经历了2次续年费后服务器ip被加黑名单之后，算是彻底放弃了（心痛100刀😭），说的就是帮瓦工。vultr的服务器虽然稳定，但是延迟比较高，糟糕的时候甚至连油管的高清视频都卡顿，不过大部分时间都是轻度搜索场景，也就还能使用。那时候也知道“机场”的概念，不过自己搭的服务用着放心么不是，机场随时跑路的，就一直没用。而且vultr的服务器，5刀/月，价格也在可接受的范围内。"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-15T00:00:00+08:00"><meta property="article:modified_time" content="2024-06-15T00:00:00+08:00"><meta property="article:tag" content="Integration"><title>主动管理Clash的代理配置 | xf&amp;pl</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://wangy325.github.io/zh-cn/posts/2024/20240615_%E4%B8%BB%E5%8A%A8%E6%89%98%E7%AE%A1Clash%E9%85%8D%E7%BD%AE/><link rel=stylesheet href=/book.min.dc7b67613526b8d54c97dc54357067bc78ca03922ac3d66ac764ed621486ec48.css integrity="sha256-3HtnYTUmuNVMl9xUNXBnvHjKA5Iqw9Zqx2TtYhSG7Eg=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/zh-cn.search.min.65e7e7e06dcefc1c6073cbcc2be10d85a52b896ba9159689decb413f5f9858d6.js integrity="sha256-Zefn4G3O/Bxgc8vMK+ENhaUriWupFZaJ3stBP1+YWNY=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-HHNKR5H8KN"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HHNKR5H8KN")}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=navi-bar id=navibar><div id=page-title><h2 class=book-brand><a class="flex align-center" href=/zh-cn/><span>xf&amp;pl</span></a></h2></div><div class=page-navi-col><nav><ul><li><a href=/zh-cn/docs/java/>Java</a></li><li><a href=/zh-cn/docs/design_pattern/>DP</a></li><li class=book-section-flat><a href=/zh-cn/docs/note/>Mooc</a></li><li class=book-section-flat><a href=/zh-cn/docs/snippets/>Snippets</a></li></ul><ul><li><a href=/zh-cn/posts/>Blog</a></li><li><a href=/zh-cn/archive/>Archive</a></li></ul></nav></div><div class="book-search hidden"><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/ required pattern=\S+.*>
<span class=clear_search><img src=/svg/close.svg onclick=clearInput()></span><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><script>function clearInput(){document.getElementById("book-search-input").value="";for(var e=document.getElementById("book-search-results");e.firstChild;)e.removeChild(e.firstChild)}</script><ul class=book-languages><li><a class="flex align-center"><img src=/svg/language.svg class=book-icon alt=Languages>
简体中文</a></label><ul><li><a href=https://wangy325.github.io/en/>English</a></li></ul></li></ul></div><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>主动管理Clash的代理配置</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><div id=toc-new><ul class=nav><li class=nav-item><a id=tclash配置文件的结构 href=javascript:void(0) onclick='return scrolly("clash配置文件的结构"),!1'>clash配置文件的结构</a><ul class=nav><li class=nav-item><a id=tproxyproviders href=javascript:void(0) onclick='return scrolly("proxy-providers"),!1'>proxy-providers</a></li><li class=nav-item><a id=tproxygroups href=javascript:void(0) onclick='return scrolly("proxy-groups"),!1'>proxy-groups</a></li><li class=nav-item><a id=truleproviders href=javascript:void(0) onclick='return scrolly("rule-providers"),!1'>rule-providers</a></li><li class=nav-item><a id=trules href=javascript:void(0) onclick='return scrolly("rules"),!1'>rules</a></li></ul></li><li class=nav-item><a id=t使用gist实现远程订阅 href=javascript:void(0) onclick='return scrolly("使用gist实现远程订阅"),!1'>使用gist实现远程订阅</a></li><li class=nav-item><a id=t参考 href=javascript:void(0) onclick='return scrolly("参考"),!1'>参考</a></li></ul></div><script>function scrolly(e){const t=40;var n=document.getElementById(e).offsetTop;window.scrollTo({top:n+t,behaviour:"smooth"})}</script></aside></header><article class="markdown book-post"><h1>主动管理Clash的代理配置</h1><div class="postmeta flex align-cneter" style=justify-content:center><div class="created flex align-cneter"><img src=/svg/calendar-event.svg class=book-icon alt>
<a title='创建者 wangy325'>2024-06-15</a></div><div class="cates flex align-center"><img src=/svg/cates.svg class=book-icon alt>
<a href=/zh-cn/categories/utility/>Utility</a></div><div class="tags flex align-center"><img src=/svg/tag-alt.svg class=book-icon alt>
<a href=/zh-cn/tags/Integration/>Integration</a></div></div><p>自己搭建了这么多年的shadowsocks服务，经历了2次续年费后服务器ip被加黑名单之后，算是彻底放弃了（心痛100刀😭），说的就是帮瓦工。vultr的服务器虽然稳定，但是延迟比较高，糟糕的时候甚至连油管的高清视频都卡顿，不过大部分时间都是轻度搜索场景，也就还能使用。那时候也知道“机场”的概念，不过自己搭的服务用着放心么不是，机场随时跑路的，就一直没用。而且vultr的服务器，5刀/月，价格也在可接受的范围内。</p><p>不过浸淫了那么久，发现机场的速度和稳定性确实要好过自建服务。</p><ol><li>一来稳定的机场每天都有维护，自建的服务半年都不见得上去看一眼；</li><li>二来身边有用机场的人，机场经过了时间的检验，可靠性有保证了；</li><li>三来如果不是定制化或者要求非常高，机场的价格比自建服务器便宜。</li></ol><p>综上，还是转用机场吧，别再自己折腾了。</p><p>以上为引。</p><hr><p>机场购买套餐后，一般会提供订阅链接，clash可以直接托管配置，用起来相当方便。不过机场提供的订阅使用起来，还有如下缺点：</p><ol><li>机场提供的订阅配置一般都是一大坨，不同机场的配置也有较大差异，在切换配置文件后，往往需要调整规则，或者需要测速后手动选择低延迟的节点</li><li>不能自定义，部分机场缺乏对某些地址的分流规则，可能需要手动添加，但是，机场的托管配置更新之后会覆盖用户添加的内容</li><li>机场有些“凑数”节点，不好用也基本上用不到，但是在选择节点总是展示，不够有条理</li></ol><p>实际上，只要稍微使用一段时间的clash，这些问题都不难发现。如果能够自己写规则，并管理机场提供的节点的话，以上问题都能解决。</p><h3 id=clash配置文件的结构>clash配置文件的结构
<a class=anchor href=#clash%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e7%9a%84%e7%bb%93%e6%9e%84>#</a></h3><ul><li>“head” 头部配置，主要是代理端口，模式，日志级别等基础配置</li><li>proxy-providers 核心配置，代理集，用来管理机场的节点</li><li>proxy-groups 核心配置，代理组，用来管理分流</li><li>proxies 核心配置，上述两个配置好之后，可以不配置此项，机场订阅链接一般配置此项</li><li>rule-providers 核心配置，用来订阅分流规则</li><li>rules 核心配置，控制分流规则，机场订阅仅用此来分流</li></ul><p>说起来也很简单，主要是2部分核心配置</p><ul><li>proxy 即指代服务节点</li><li>rule 即指代分流规则，即哪个网站走哪个节点</li></ul><p>自定义的话，只需要配置<code>proxy-providers</code>、<code>proxy-groups</code>、<code>rule-providers</code>和<code>rules</code>配置就行了，至于头部配置，随便抄一个就行了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln>1</span><span class=cl><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>7890</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=nt>socks-port</span><span class=p>:</span><span class=w> </span><span class=m>7891</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=nt>redir-port</span><span class=p>:</span><span class=w> </span><span class=m>7892</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w></span><span class=nt>mixed-port</span><span class=p>:</span><span class=w> </span><span class=m>7893</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=nt>allow-lan</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w></span><span class=nt>mode</span><span class=p>:</span><span class=w> </span><span class=l>rule</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w></span><span class=nt>log-level</span><span class=p>:</span><span class=w> </span><span class=l>warn</span><span class=w>
</span></span></span><span class=line><span class=ln>8</span><span class=cl><span class=w></span><span class=nt>external-controller</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;127.0.0.1:9090&#39;</span><span class=w>
</span></span></span></code></pre></div><h4 id=proxy-providers>proxy-providers
<a class=anchor href=#proxy-providers>#</a></h4><p>这是核心配置，用来管理（多个）机场的订阅，并且可以将节点分类到不同的订阅组。以下是配置示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>proxy-providers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w>  </span><span class=nt>ChinaG-tw</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w> </span><span class=c>#类型，使用http从订阅地址拉取配置</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./proxyset/ChinaG.yaml   </span><span class=w> </span><span class=c># 拉取的配置文件存放地址</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;机场提供的订阅地址&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>    </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>1800</span><span class=w> </span><span class=c># 配置更新间隔 30分钟</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>    </span><span class=nt>filter</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;TW&#39;</span><span class=w> </span><span class=c># 节点过滤，根据机场提供的名字来，这里过滤含有‘TW’两个字母的节点</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>health-check</span><span class=p>:</span><span class=w> </span><span class=c># 健康检查</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>      </span><span class=nt>enable</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>http://www.gstatic.com/generate_204 </span><span class=w> </span><span class=c># 健康检查地址</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>300</span><span class=w> </span><span class=c># 检查间隔 5分钟</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>ChinaG-hk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>file</span><span class=w> </span><span class=c># 从本地配置文件读取节点</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./proxyset/ChinaG.yaml</span><span class=w> </span><span class=c># 这里是将上面机场的节点分组，故直接使用上面拉取的配置</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>        </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>3600</span><span class=w> 
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>        </span><span class=nt>filter</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;HK|SG&#39;</span><span class=w> </span><span class=c># 节点过滤 这里过滤含有&#39;HK&#39;或者&#39;SG&#39;的节点</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>        </span><span class=nt>health-check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>            </span><span class=nt>enable</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>            </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>http://www.gstatic.com/generate_204</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>            </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>300</span><span class=w>
</span></span></span></code></pre></div><p>以上就是2种不同的配置<code>proxy-providers</code>方式。</p><p>有时候，机场提供的订阅地址可能无法顺利拉取下来，这时候可能需要一点特殊的处理，一般是对订阅地址进行
<a href=https://www.urlencoder.org/>urlEncode</a>后，通过subconverter拉取。具体过程参照引文2。</p><h4 id=proxy-groups>proxy-groups
<a class=anchor href=#proxy-groups>#</a></h4><p><code>proxy-groups</code>理解为策略组，也就是单击clash图标后，显示的那些选择节点的配置。这些配置一般机场都会提供，开箱即用的。手撸之后的好处就是，不用忍受不同机场的配置差异，总是一样的选单。</p><p>以下是<code>proxy-groups</code>配置示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>proxy-groups</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>🎯境外流量 </span><span class=w> </span><span class=c># 策略组名字</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>select  </span><span class=w> </span><span class=c># 类型 自动选择</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>    </span><span class=nt>use</span><span class=p>:</span><span class=w> </span><span class=c># 使用哪些proxy-providers</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>      </span>- <span class=l>ChinaG-tw</span><span class=w> </span><span class=c># 上一步配置的代理集名字</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>      </span>- <span class=l>ChinaG-hk</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>      </span>- <span class=l>Coffee-hk</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>proxies</span><span class=p>:</span><span class=w>    </span><span class=c># 使用哪些代理</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>      </span>- <span class=l>DIRECT</span><span class=w> </span><span class=c># clash自带的，直连</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span>- <span class=l>🥤亚洲咖啡   </span><span class=w> </span><span class=c># 下面配置的策略组</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>🥤亚洲咖啡</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>url-test</span><span class=w> </span><span class=c># 自动测速并选择节点</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>http://www.gstatic.com/generate_204   </span><span class=w> </span><span class=c># 测速地址</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>    </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>300</span><span class=w>   </span><span class=c># 测速间隔</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span><span class=nt>use</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span>- <span class=l>Coffee-asia </span><span class=w>
</span></span></span></code></pre></div><h4 id=rule-providers>rule-providers
<a class=anchor href=#rule-providers>#</a></h4><p>一般机场提供的配置不会配置此项目，而是把所有的ip/域名规则一股脑全塞进<code>rules</code>配置里，差一点的，整个配置文件几千行，良心一点的机场，配置文件动辄几万行。虽然功能相同，但是确实看着累人。</p><p><code>rule-providers</code>相当于是从互联网拉取分流规则，这些规则有人维护，并且持续更新，这样方便多了。</p><p>以下是<code>rule-providers</code>配置示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=w>  </span><span class=nt>YouTube</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w>    </span><span class=nt>behavior</span><span class=p>:</span><span class=w> </span><span class=l>classical </span><span class=w> </span><span class=c># 用于yaml结尾的url</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>http </span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/Ruleset/YouTube.yaml</span><span class=w> </span><span class=c># 规则地址</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>    </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>86400</span><span class=w> </span><span class=c># 更新间隔 1个月</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./ruleset/YouTube.yaml</span><span class=w> </span><span class=c># 存放地址</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>google</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>behavior</span><span class=p>:</span><span class=w> </span><span class=l>domain</span><span class=w> </span><span class=c># 用于txt结尾的url</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./ruleset/google.yaml</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>86400</span><span class=w>
</span></span></span></code></pre></div><p>拉取下来的实际上是<code>rules</code>的子集，这样是方便管理，简化配置。</p><h4 id=rules>rules
<a class=anchor href=#rules>#</a></h4><p>分流规则的核心配置。既然配置了<code>rule-providers</code>，那么<code>rules</code>的配置自然是要按照上面的配置来。</p><p>以下是配置示例:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln>1</span><span class=cl><span class=w>  </span>- <span class=l>DOMAIN-SUFFIX,bing.com,🥤亚洲咖啡 </span><span class=w> </span><span class=c># 自定义规则 bing.com走代理访问国际版</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>  </span><span class=c># 规则集  对应的规则集名字 对应的proxy-groups名字</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w>  </span>- <span class=l>RULE-SET,YouTube,🎬️Youtube </span><span class=w> </span><span class=c>#YouTube规则集里的流量都走🎬️Youtube出</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>  </span>- <span class=l>RULE-SET,google,🎯境外流量</span><span class=w> </span><span class=c># google规则集的流量都走🎯境外流量出</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w>  </span>- <span class=l>GEOIP,LAN,DIRECT</span><span class=w> </span><span class=c># 局域网直连</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w>  </span>- <span class=l>GEOIP,CN,DIRECT</span><span class=w> </span><span class=c># 国内ip直连</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w>  </span>- <span class=l>MATCH,🐟漏网之鱼</span><span class=w> </span><span class=c># 白名单模式 未匹配上的域名走🐟漏网之鱼代理组出</span><span class=w>
</span></span></span></code></pre></div><p>以上就是手撸clash配置的全部内容。</p><h3 id=使用gist实现远程订阅>使用gist实现远程订阅
<a class=anchor href=#%e4%bd%bf%e7%94%a8gist%e5%ae%9e%e7%8e%b0%e8%bf%9c%e7%a8%8b%e8%ae%a2%e9%98%85>#</a></h3><p>实际上，这一步并没有什么必要，如果是本地使用的话。不过如果想多端使用，可以使用gist托管配置然后远程订阅。</p><p>实现也很简单，创建新的<strong>私密</strong>gist，把配置文件贴上去。点击<code>raw</code>查看配置文件，复制地址栏的链接，去掉链接中raw到文件名
中间的字符串，剩下的部分可以直接使用clash订阅。</p><h3 id=参考>参考
<a class=anchor href=#%e5%8f%82%e8%80%83>#</a></h3><ol><li><a href=https://cn.v2ex.com/t/964122>机场规则优化-v2ex</a></li><li><a href=https://limbopro.com/archives/subconverter.html#%E4%BD%BF%E7%94%A8%E7%9A%84%E5%88%86%E6%B5%81%E8%A7%84%E5%88%99/%E7%AD%96%E7%95%A5%E5%8F%8A%E8%84%9A%E6%9C%AC%E8%AF%B4%E6%98%8E%EF%BC%88%E5%BF%85%E7%9C%8B%EF%BC%89>你的订阅地址无法读取？试试这个</a></li><li><a href=https://www.skyqian.com/archives/clash-testlink.html>适用于clash的测速地址</a></li><li><a href=https://github.com/Loyalsoldier/clash-rules>clash rules规则集</a></li><li><a href=https://jamesdaily.life/rule-proxy-provider>clash分流的终极方法</a></li><li><a href=../../docs/snippets/gist/clash_pro.md>配置示例</a></li></ol></article><div class=next-prev><hr><div class="page-navi flex" id=pagenavi><div class=pre-page>←
<a href=https://wangy325.github.io/zh-cn/posts/2024/20240621_use-coze-plugin-and-workflow/>使用Coze的插件和工作流创建自定义AI工具</a></div><div class=next-page><a href=https://wangy325.github.io/zh-cn/posts/2024/20240612_%E6%9B%B4%E6%8D%A2%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98/>更换个人博客主题</a> →</div></div></div><section class=related><div class=rel-title>相似文章</div><div class=rel-items><a href=/zh-cn/posts/2024/20240612_%E6%9B%B4%E6%8D%A2%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98/ class=related__link><div>更换个人博客主题</div></a><a href=/zh-cn/posts/2024/20240606_Rime%E4%B8%AD%E5%B7%9E%E9%9F%BB%E8%BC%B8%E5%85%A5%E5%BC%95%E6%93%8E%E5%AE%89%E8%A3%9D%E8%88%87%E7%B0%A1%E5%96%AE%E8%AA%BF%E6%95%99/ class=related__link><div>Rime中州韻輸入引擎安裝與輸入方案定製指北</div></a></div><hr></section><div class=book-comments><div class=giscus-thread></div><script src=https://giscus.app/client.js data-repo=wangy325/wangy325.github.io data-repo-id=R_kgDOHhhDZg data-category=Announcements data-category-id=DIC_kwDOHhhDZs4ChbMn data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=noborder_light data-loading=lazy data-lang=zh-CN crossorigin=anonymous async></script></div><div class=copyright><hr class=cline><p>Notes and Memos by wangy325
<a href=https://creativecommons.org/licenses/by/4.0/deed.en title="Creative Commons Attribution">&copy; CC BY 4.0</a></p><p>2019-2025. Powered by
<a href=https://github.com/alex-shpak/hugo-book>Hugo Book</a>
Presented by Github.</p></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><div id=toc-new><ul class=nav><li class=nav-item><a id=tclash配置文件的结构 href=javascript:void(0) onclick='return scrolly("clash配置文件的结构"),!1'>clash配置文件的结构</a><ul class=nav><li class=nav-item><a id=tproxyproviders href=javascript:void(0) onclick='return scrolly("proxy-providers"),!1'>proxy-providers</a></li><li class=nav-item><a id=tproxygroups href=javascript:void(0) onclick='return scrolly("proxy-groups"),!1'>proxy-groups</a></li><li class=nav-item><a id=truleproviders href=javascript:void(0) onclick='return scrolly("rule-providers"),!1'>rule-providers</a></li><li class=nav-item><a id=trules href=javascript:void(0) onclick='return scrolly("rules"),!1'>rules</a></li></ul></li><li class=nav-item><a id=t使用gist实现远程订阅 href=javascript:void(0) onclick='return scrolly("使用gist实现远程订阅"),!1'>使用gist实现远程订阅</a></li><li class=nav-item><a id=t参考 href=javascript:void(0) onclick='return scrolly("参考"),!1'>参考</a></li></ul></div><script>function scrolly(e){const t=40;var n=document.getElementById(e).offsetTop;window.scrollTo({top:n+t,behaviour:"smooth"})}</script></div></aside></main><div class=back-to-top><div id=back-to-top><img src=/svg/chevrons-up.svg srcset="/svg/chevrons-up.svg 500w" onclick=topFunction() class=black>
<img title=回到顶部 src=/svg/chevrons-up-blue.svg srcset="/svg/chevrons-up-blue.svg 500w" onclick=topFunction() class=blue></div><script>let mybutton=document.getElementById("back-to-top");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>500||document.documentElement.scrollTop>500?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){window.scrollTo({top:0,behavior:"smooth"})}</script></div><script src=/js/scroll-listening.js></script></body></html>
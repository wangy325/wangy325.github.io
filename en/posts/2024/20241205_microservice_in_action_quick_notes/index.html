<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This is quick notes of learning Spring microservice in action(2nd edition). To be clarified, Spring-Boot and Spring-Cloud version are little different from book.
Here are versions used:

Spring-Boot version 2.6.13
Spring-Cloud version 2021.0.5
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://wangy325.github.io/en/posts/2024/20241205_microservice_in_action_quick_notes/"><meta property="og:site_name" content="xf&pl"><meta property="og:title" content="Quick notes of microservice in action"><meta property="og:description" content="This is quick notes of learning Spring microservice in action(2nd edition). To be clarified, Spring-Boot and Spring-Cloud version are little different from book.
Here are versions used:
Spring-Boot version 2.6.13 Spring-Cloud version 2021.0.5"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-05T00:00:00+08:00"><meta property="article:modified_time" content="2025-03-04T20:16:14+08:00"><meta property="article:tag" content="Spring Cloud"><title>Quick notes of microservice in action | xf&amp;pl</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://wangy325.github.io/en/posts/2024/20241205_microservice_in_action_quick_notes/><link rel=stylesheet href=/book.min.b3c35582f793f8698430900c951e043987ef545ae9292888a87c0d14a3f9e018.css integrity="sha256-s8NVgveT+GmEMJAMlR4EOYfvVFrpKSiIqHwNFKP54Bg=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.90ca9cbea1c98bace1ce15dad7addcd86e7eb8e9c119c10764cae54943613c0e.js integrity="sha256-kMqcvqHJi6zhzhXa163c2G5+uOnBGcEHZMrlSUNhPA4=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-HHNKR5H8KN"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HHNKR5H8KN")}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><div class=navi-bar id=navibar><div id=page-title><h2 class=book-brand><a class="flex align-center" href=/en/><span>xf&amp;pl</span></a></h2></div><div class=page-navi-col><nav><ul><li><a href=/en/posts/>Blog</a></li><li><a href=/en/archive/>Archive</a></li><li><a href=/en/about/>About</a></li></ul></nav></div><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/ required pattern=\S+.*>
<span class=clear_search><img src=/svg/close.svg onclick=clearInput()></span><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><script>function clearInput(){document.getElementById("book-search-input").value="";for(var e=document.getElementById("book-search-results");e.firstChild;)e.removeChild(e.firstChild)}</script><ul class=book-languages><li><a class="flex align-center"><img src=/svg/language.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=https://wangy325.github.io/zh-cn/>简体中文</a></li></ul></li></ul></div><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/en/><span>xf&amp;pl</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=/zh-cn/>简体中文</a></li></ul></li></ul><ul><li><a href=/en/posts/>Blog</a></li><li><a href=/en/archive/>Archive</a></li><li><a href=/en/about/>About</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Quick notes of microservice in action</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><div id=toc-new><ul class=nav><li class=nav-item><a id=t1Nospringconfigimportpropertyhasbeendefined href=javascript:void(0) onclick='return scrolly("1-no-springconfigimport-property-has-been-defined"),!1'>1) No spring.config.import property has been defined</a></li><li class=nav-item><a id=t2SpringcloudconfigGitbackendwithsshauthentication href=javascript:void(0) onclick='return scrolly("2-spring-cloud-config-git-backend-with-ssh-authentication"),!1'>2) Spring cloud config Git backend with ssh authentication</a></li><li class=nav-item><a id=t3ConfigsensitiveinfoasenvvariablesinDockerCompose href=javascript:void(0) onclick='return scrolly("3-config-sensitive-info-as-env-variables-in-docker-compose"),!1'>3) Config sensitive info as env variables in Docker Compose</a></li><li class=nav-item><a id=t4DebugMicroServicelocallywithdockerandIDEA href=javascript:void(0) onclick='return scrolly("4-debug-micro-service-locally-with-docker-and-idea"),!1'>4) Debug Micro Service locally with docker and IDEA</a></li><li class=nav-item><a id=t5SpringClouddiscoveryclientandloadbalancer href=javascript:void(0) onclick='return scrolly("5-spring-cloud-discovery-client-and-loadbalancer"),!1'>5) Spring-Cloud discovery client and loadbalancer</a><ul class=nav><li class=nav-item><a id=t51DiscoveryClientNotrecommended href=javascript:void(0) onclick='return scrolly("51-discoveryclient-not-recommended"),!1'>5.1 DiscoveryClient (Not recommended)</a></li><li class=nav-item><a id=t52RestTemplatewithLoadBalanced href=javascript:void(0) onclick='return scrolly("52-resttemplate-with-loadbalanced"),!1'>5.2 RestTemplate with @LoadBalanced</a></li><li class=nav-item><a id=t53OpenFeign href=javascript:void(0) onclick='return scrolly("53-openfeign"),!1'>5.3 OpenFeign</a></li><li class=nav-item><a id=t54Otherapproaches href=javascript:void(0) onclick='return scrolly("54-other-approaches"),!1'>5.4 Other approaches</a><ul class=nav><li class=nav-item><a id=tUsingaReactiveLoadBalancedWebClients href=javascript:void(0) onclick='return scrolly("using-a-reactiveloadbalanced-webclients"),!1'>Using a ReactiveLoadBalanced WebClients</a></li></ul></li></ul></li></ul></div><script>function scrolly(e){const t=40;var n=document.getElementById(e).offsetTop;window.scrollTo({top:n+t,behaviour:"smooth"})}</script></aside></header><article class="markdown book-post"><h1>Quick notes of microservice in action</h1><div class="postmeta flex align-cneter" style=justify-content:center><div class="created flex align-cneter"><img src=/svg/calendar-event.svg class=book-icon alt>
<a title='Created by wangy325'>2024-12-05</a></div><div class="tags flex align-center"><img src=/svg/tag-alt.svg class=book-icon alt>
<a href=/en/tags/spring-cloud/>Spring Cloud</a></div><div class="last-modified flex align center"><img src=/svg/edit.svg class=book-icon alt>
<a title='Last modified by wangy325 | 2025-03-04'>2025-03-04</a></div></div><p>This is quick notes of learning Spring microservice in action(2nd edition). To be clarified, Spring-Boot and Spring-Cloud version are little different from book.</p><p>Here are versions used:</p><ul><li>Spring-Boot version <code>2.6.13</code></li><li>Spring-Cloud version <code>2021.0.5</code></li></ul><p>Whereas the guide book <code>Spring Microservice In Action(2nd edition)</code> uses <code>2.2.3.RELEASE</code> for spring-boot
and <code>Hoxton.SR1</code> for spring-cloud. Which introduces some version 'traps'.</p><h3 id=1-no-springconfigimport-property-has-been-defined>1) No spring.config.import property has been defined
<a class=anchor href=#1-no-springconfigimport-property-has-been-defined>#</a></h3><p>While configuring <code>licensing-service</code> as <strong>Spring Cloud Config Client</strong>, I encountered this error. After googled,
I found that was a new version of spring with old configuration style.</p><blockquote><p>You're getting this error because you're using a new version of Spring Boot and Spring Cloud, but you're trying to configure it in the old way.</p></blockquote><p>Here is the full answer link:
<a href=https://stackoverflow.com/questions/67507452/no-spring-config-import-property-has-been-defined>https://stackoverflow.com/questions/67507452/no-spring-config-import-property-has-been-defined</a></p><p>Spring Boot 2.4(later) introduced a new way to import config data.</p><p>Here is official doc:
<a href=https://docs.spring.io/spring-cloud-config/docs/current/reference/html/#_spring_cloud_config_client>https://docs.spring.io/spring-cloud-config/docs/current/reference/html/#_spring_cloud_config_client</a></p><p>2 solutions were provided to solve problem.</p><h3 id=2-spring-cloud-config-git-backend-with-ssh-authentication>2) Spring cloud config Git backend with ssh authentication
<a class=anchor href=#2-spring-cloud-config-git-backend-with-ssh-authentication>#</a></h3><p>Use command</p><pre tabindex=0><code class=language-ssh data-lang=ssh>ssh-keygen -m PEM -t rsa -b 4096 -f config_server_deploy_key.rsa
</code></pre><p>to gen rsa key pair.</p><p>Then config spring cloud config server like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=w>  </span><span class=nt>spring</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w>    </span><span class=nt>cloud</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>      </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>        </span><span class=nt>server</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>          </span><span class=nt>git</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>            </span><span class=nt>uri</span><span class=p>:</span><span class=w> </span><span class=l>git@gitserver.com:team/repo1.git</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>            </span><span class=nt>ignoreLocalSshSettings</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w></span><span class=c>#            hostKey: someHostKey</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w></span><span class=c>#            hostKeyAlgorithm: ssh-rsa</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>            </span><span class=nt>privateKey</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=sd>                         -----BEGIN RSA PRIVATE KEY-----
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=sd>                         MIIEpgIBAAKCAQEAx4UbaDzY5xjW6hc9jwN0mX33XpTDVW9WqHp5AKaRbtAC3DqX
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=sd>                         IXFMPgw3K45jxRb93f8tv9vL3rD9CUG1Gv4FM+o7ds7FRES5RTjv2RT/JVNJCoqF
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=sd>                         ol8+ngLqRZCyBtQN7zYByWMRirPGoDUqdPYrj2yq+ObBBNhg5N+hOwKjjpzdj2Ud
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=sd>                         1l7R+wxIqmJo1IYyy16xS8WsjyQuyC0lL456qkd5BDZ0Ag8j2X9H9D5220Ln7s9i
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=sd>                         oezTipXipS7p7Jekf3Ywx6abJwOmB0rX79dV4qiNcGgzATnG1PkXxqt76VhcGa0W
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=sd>                         DDVHEEYGbSQ6hIGSh0I7BQun0aLRZojfE3gqHQIDAQABAoIBAQCZmGrk8BK6tXCd
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=sd>                         fY6yTiKxFzwb38IQP0ojIUWNrq0+9Xt+NsypviLHkXfXXCKKU4zUHeIGVRq5MN9b
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=sd>                         BO56/RrcQHHOoJdUWuOV2qMqJvPUtC0CpGkD+valhfD75MxoXU7s3FK7yjxy3rsG
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=sd>                         EmfA6tHV8/4a5umo5TqSd2YTm5B19AhRqiuUVI1wTB41DjULUGiMYrnYrhzQlVvj
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=sd>                         5MjnKTlYu3V8PoYDfv1GmxPPh6vlpafXEeEYN8VB97e5x3DGHjZ5UrurAmTLTdO8
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=sd>                         +AahyoKsIY612TkkQthJlt7FJAwnCGMgY6podzzvzICLFmmTXYiZ/28I4BX/mOSe
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=sd>                         pZVnfRixAoGBAO6Uiwt40/PKs53mCEWngslSCsh9oGAaLTf/XdvMns5VmuyyAyKG
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=sd>                         ti8Ol5wqBMi4GIUzjbgUvSUt+IowIrG3f5tN85wpjQ1UGVcpTnl5Qo9xaS1PFScQ
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=sd>                         xrtWZ9eNj2TsIAMp/svJsyGG3OibxfnuAIpSXNQiJPwRlW3irzpGgVx/AoGBANYW
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=sd>                         dnhshUcEHMJi3aXwR12OTDnaLoanVGLwLnkqLSYUZA7ZegpKq90UAuBdcEfgdpyi
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=sd>                         PhKpeaeIiAaNnFo8m9aoTKr+7I6/uMTlwrVnfrsVTZv3orxjwQV20YIBCVRKD1uX
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=sd>                         VhE0ozPZxwwKSPAFocpyWpGHGreGF1AIYBE9UBtjAoGBAI8bfPgJpyFyMiGBjO6z
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=sd>                         FwlJc/xlFqDusrcHL7abW5qq0L4v3R+FrJw3ZYufzLTVcKfdj6GelwJJO+8wBm+R
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=sd>                         gTKYJItEhT48duLIfTDyIpHGVm9+I1MGhh5zKuCqIhxIYr9jHloBB7kRm0rPvYY4
</span></span></span><span class=line><span class=ln>31</span><span class=cl><span class=sd>                         VAykcNgyDvtAVODP+4m6JvhjAoGBALbtTqErKN47V0+JJpapLnF0KxGrqeGIjIRV
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=sd>                         cYA6V4WYGr7NeIfesecfOC356PyhgPfpcVyEztwlvwTKb3RzIT1TZN8fH4YBr6Ee
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=sd>                         KTbTjefRFhVUjQqnucAvfGi29f+9oE3Ei9f7wA+H35ocF6JvTYUsHNMIO/3gZ38N
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=sd>                         CPjyCMa9AoGBAMhsITNe3QcbsXAbdUR00dDsIFVROzyFJ2m40i4KCRM35bC/BIBs
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=sd>                         q0TY3we+ERB40U8Z2BvU61QuwaunJ2+uGadHo58VSVdggqAo0BSkH58innKKt96J
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=sd>                         69pcVH/4rmLbXdcmNYGm6iu+MlPQk4BUZknHSmVHIFdJ0EPupVaQ8RHT
</span></span></span><span class=line><span class=ln>37</span><span class=cl><span class=sd>                         -----END RSA PRIVATE KEY-----</span><span class=w>
</span></span></span></code></pre></div><p>Note: <code>hostKey</code> and <code>hostkeyAlgorithm</code> are no necessary configuration items.</p><p>Do Not forget to add public key to your gitHub settings.</p><blockquote><p>By the way, if you already have an ssh key-pair in your local machine, just use it!</p></blockquote><p>Referring official guide to learn more about git backend:
<a href=https://docs.spring.io/spring-cloud-config/docs/current/reference/html/#_spring_cloud_config_server>https://docs.spring.io/spring-cloud-config/docs/current/reference/html/#_spring_cloud_config_server</a></p><h3 id=3-config-sensitive-info-as-env-variables-in-docker-compose>3) Config sensitive info as env variables in Docker Compose
<a class=anchor href=#3-config-sensitive-info-as-env-variables-in-docker-compose>#</a></h3><p>Use System Environment Variable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=ln>1</span><span class=cl>docker compose run -e <span class=nv>KEY_OF_ENV</span><span class=o>=</span>value web python app.py
</span></span></code></pre></div><h3 id=4-debug-micro-service-locally-with-docker-and-idea>4) Debug Micro Service locally with docker and IDEA
<a class=anchor href=#4-debug-micro-service-locally-with-docker-and-idea>#</a></h3><p>Docker services:</p><ul><li>config server</li><li>eureka server</li><li>database</li></ul><p>IDEA services:</p><ul><li>licensing service</li><li>organization service</li></ul><p>IDEA services need some extra configurations(program arguments) to
override config server's backend configuration.</p><p>Use <code>--key=value</code> to do that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=ln>1</span><span class=cl>--eureka.client.serviceUrl.defaultZone<span class=o>=</span>http://localhost:8070/eureka
</span></span><span class=line><span class=ln>2</span><span class=cl>--spring.datasource.url<span class=o>=</span>jdbc:postgresql://localhost:5432/ostock_dev
</span></span><span class=line><span class=ln>3</span><span class=cl>--spring.config.import<span class=o>=</span>optional:configserver:http://localhost:8071
</span></span></code></pre></div><h3 id=5-spring-cloud-discovery-client-and-loadbalancer>5) Spring-Cloud discovery client and loadbalancer
<a class=anchor href=#5-spring-cloud-discovery-client-and-loadbalancer>#</a></h3><p>After introducing eureka client to licensing service, we also introduced <code>spring-cloud-starter-loadbalancer</code>
and <code>spring-cloud-starter-openfeign</code>, which provide load-balance and microservice remote invoking ability to licensing service.</p><p>There 3 ways to achieve remote call, introduced by the book(microservice in action).</p><ul><li>DiscoveryClient (Without load balance)</li><li>RestTemplate</li><li>OpenFeign</li></ul><h4 id=51-discoveryclient-not-recommended>5.1 DiscoveryClient (Not recommended)
<a class=anchor href=#51-discoveryclient-not-recommended>#</a></h4><p>To Use <code>DiscoveryClient</code> in Spring Cloud, just inject <code>DiscoveryClient</code> bean into services.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln> 1</span><span class=cl><span class=nd>@Component</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrganizationDiscoveryClient</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>DiscoveryClient</span><span class=w> </span><span class=n>discoveryClient</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=cm>     * No LoadBalanced
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Organization</span><span class=w> </span><span class=nf>getOrganization</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>organizationId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>        </span><span class=n>RestTemplate</span><span class=w> </span><span class=n>restTemplate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RestTemplate</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>ServiceInstance</span><span class=o>&gt;</span><span class=w> </span><span class=n>instances</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>discoveryClient</span><span class=p>.</span><span class=na>getInstances</span><span class=p>(</span><span class=s>&#34;organization-service&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>instances</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>serviceUri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>format</span><span class=p>(</span><span class=s>&#34;%s/v1/organization/%s&#34;</span><span class=p>,</span><span class=n>instances</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>0</span><span class=p>).</span><span class=na>getUri</span><span class=p>().</span><span class=na>toString</span><span class=p>(),</span><span class=w> </span><span class=n>organizationId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>        </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=w> </span><span class=n>Organization</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>restExchange</span><span class=w> </span><span class=o>=</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>            </span><span class=n>restTemplate</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>                </span><span class=n>serviceUri</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>                </span><span class=n>HttpMethod</span><span class=p>.</span><span class=na>GET</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>                </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>Organization</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>organizationId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>restExchange</span><span class=p>.</span><span class=na>getBody</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><code>DiscoveryClient</code> actually get all service instances by service name you set in eureka client.
The service name was set by <code>spring.application,name</code> property.</p><p>And you could find out that <code>DiscoveryClient</code> was used to get remote service's url, and service was invoked by <code>RestTemplate</code>.</p><p>As you can see, there are still some 'hard code' in there, and <code>DiscoveryClient</code> always get the first service's url, which means
Spring Cloud load-balance did not work in this scenario.</p><h4 id=52-resttemplate-with-loadbalanced>5.2 RestTemplate with <code>@LoadBalanced</code>
<a class=anchor href=#52-resttemplate-with-loadbalanced>#</a></h4><p>If you want your <code>RestTemplate</code> run as load-balanced client, you need to config it with <code>@LoadBalanced</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln>1</span><span class=cl><span class=nd>@LoadBalanced</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>RestTemplate</span><span class=w> </span><span class=nf>getRestTemplate</span><span class=p>(){</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RestTemplate</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Then you can use <code>RestTemplate</code> like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln> 1</span><span class=cl><span class=nd>@Component</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrganizationRestTemplateClient</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>    </span><span class=n>RestTemplate</span><span class=w> </span><span class=n>restTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Organization</span><span class=w> </span><span class=nf>getOrganization</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>organizationId</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>        </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>Organization</span><span class=o>&gt;</span><span class=w> </span><span class=n>restExchange</span><span class=w> </span><span class=o>=</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>            </span><span class=n>restTemplate</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>                </span><span class=s>&#34;http://organization-service/v1/organization/{organizationId}&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>                </span><span class=n>HttpMethod</span><span class=p>.</span><span class=na>GET</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>                </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>Organization</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>organizationId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>restExchange</span><span class=p>.</span><span class=na>getBody</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>If you have more than 1 instances of organization service, the <code>RestTemplate</code> will query each instances Round-Robbin.</p><h4 id=53-openfeign>5.3 OpenFeign
<a class=anchor href=#53-openfeign>#</a></h4><blockquote><p>Spring Cloud integrates Eureka, Spring Cloud CircuitBreaker, as well as Spring Cloud LoadBalancer to provide a
load-balanced http client when using Feign.</p></blockquote><p>By using OpenFeign integrated with Spring Cloud, it already supported a load-balanced http-client.</p><p>The way to use <code>OpenFeign</code> is simple:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln>1</span><span class=cl><span class=nd>@FeignClient</span><span class=p>(</span><span class=s>&#34;organization-service&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>OrganizationFeignClient</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>    </span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w>        </span><span class=n>method</span><span class=o>=</span><span class=w> </span><span class=n>RequestMethod</span><span class=p>.</span><span class=na>GET</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w>        </span><span class=n>value</span><span class=o>=</span><span class=s>&#34;/v1/organization/{organizationId}&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w>        </span><span class=n>consumes</span><span class=o>=</span><span class=s>&#34;application/json&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>8</span><span class=cl><span class=w>    </span><span class=n>Organization</span><span class=w> </span><span class=nf>getOrganization</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=p>(</span><span class=s>&#34;organizationId&#34;</span><span class=p>)</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>organizationId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>9</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Do not forget to annotate Main-class with <code>@EnableFeignClients</code>.</p><h4 id=54-other-approaches>5.4 Other approaches
<a class=anchor href=#54-other-approaches>#</a></h4><p>Except ways mentioned above, there are other approaches to achieve RPC in Spring of course.</p><p>Spring WebFlux is a alternative:</p><ul><li><a href=https://docs.spring.io/spring-cloud-commons/docs/3.1.8/reference/html/#webclinet-loadbalancer-client>WebClient</a></li><li><a href=https://docs.spring.io/spring-cloud-commons/docs/3.1.8/reference/html/#webflux-with-reactive-loadbalancer>WebFlux WebClient</a></li></ul><p>More information, read:</p><ul><li><a href=https://docs.spring.io/spring-cloud-commons/docs/3.1.8/reference/html/#spring-cloud-loadbalancer>https://docs.spring.io/spring-cloud-commons/docs/3.1.8/reference/html/#spring-cloud-loadbalancer</a></li><li><a href=https://docs.spring.io/spring-cloud-openfeign/docs/3.1.9/reference/html/>https://docs.spring.io/spring-cloud-openfeign/docs/3.1.9/reference/html/</a></li></ul><h5 id=using-a-reactiveloadbalanced-webclients>Using a ReactiveLoadBalanced WebClients
<a class=anchor href=#using-a-reactiveloadbalanced-webclients>#</a></h5><p>Filter <code>UserContextFunctionFilter</code> uses to transmit correlationId and other HTTP Headers like JWT while micro service invoking.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln> 1</span><span class=cl><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=n>ReactorLoadBalancerExchangeFilterFunction</span><span class=w> </span><span class=n>lbFunction</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=cm>/**
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=cm> * {@link WebClient} load balancer HTTP client
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=cm> */</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w></span><span class=nd>@LoadBalanced</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>WebClient</span><span class=p>.</span><span class=na>Builder</span><span class=w> </span><span class=nf>getWebclient</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>WebClient</span><span class=p>.</span><span class=na>builder</span><span class=p>().</span><span class=na>filters</span><span class=p>(</span><span class=n>f</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>       </span><span class=n>f</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>UserContextFunctionFilter</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>       </span><span class=n>f</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>lbFunction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>And the <code>UserContextFunctionFilter</code> looks like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=ln> 1</span><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>UserContextFunctionFilter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>ExchangeFilterFunction</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Mono</span><span class=o>&lt;</span><span class=n>ClientResponse</span><span class=o>&gt;</span><span class=w> </span><span class=nf>filter</span><span class=p>(</span><span class=n>ClientRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>ExchangeFunction</span><span class=w> </span><span class=n>next</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>        </span><span class=n>ClientRequest</span><span class=w> </span><span class=n>buildRequest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ClientRequest</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>request</span><span class=p>).</span><span class=na>headers</span><span class=p>(</span><span class=n>h</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>            </span><span class=n>h</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>UserContext</span><span class=p>.</span><span class=na>CORRELATION_ID</span><span class=p>,</span><span class=w> </span><span class=n>UserContextHolder</span><span class=p>.</span><span class=na>getContext</span><span class=p>().</span><span class=na>getCorrelationId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>            </span><span class=n>h</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>UserContext</span><span class=p>.</span><span class=na>AUTH_TOKEN</span><span class=p>,</span><span class=w> </span><span class=n>UserContextHolder</span><span class=p>.</span><span class=na>getContext</span><span class=p>().</span><span class=na>getAuthToken</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>        </span><span class=p>}).</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>next</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=n>buildRequest</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>There is a warning info by spring BeanPostProcessorAutoConfiguration:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=ln>1</span><span class=cl>2024-12-17 08:29:57.580  INFO 1 --- [           main] trationDelegate$BeanPostProcessorChecker :Bean &#39;org.springframework.cloud.client.loadbalancer.reactive.LoadBalancerBeanPostProcessorAutoConfiguration&#39; of type [org.springframework.cloud.client.loadbalancer.reactive.LoadBalancerBeanPostProcessorAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
</span></span><span class=line><span class=ln>2</span><span class=cl>2024-12-17 08:29:57.594  INFO 1 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean &#39;org.springframework.cloud.client.loadbalancer.reactive.LoadBalancerBeanPostProcessorAutoConfiguration$ReactorDeferringLoadBalancerFilterConfig&#39; of type [org.springframework.cloud.client.loadbalancer.reactive.LoadBalancerBeanPostProcessorAutoConfiguration$ReactorDeferringLoadBalancerFilterConfig] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
</span></span><span class=line><span class=ln>3</span><span class=cl>2024-12-17 08:29:57.605  INFO 1 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean &#39;reactorDeferringLoadBalancerExchangeFilterFunction&#39; of type [org.springframework.cloud.client.loadbalancer.reactive.DeferringLoadBalancerExchangeFilterFunction] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
</span></span></code></pre></div><p>This <code>...is not eligible for getting processed by all BeanPostProcessors</code> info always causes by
<a href=https://www.baeldung.com/spring-not-eligible-for-auto-proxying>circle dependency</a>.</p><p>This info Spring Cloud did not fix it officially yet.</p><ul><li><a href=https://stackoverflow.com/questions/73782826/loadbalancerbeanpostprocessorautoconfiguration-is-not-eligible-for-getting-pro>https://stackoverflow.com/questions/73782826/loadbalancerbeanpostprocessorautoconfiguration-is-not-eligible-for-getting-pro</a></li><li><a href=https://github.com/spring-cloud/spring-cloud-commons/pull/1361>https://github.com/spring-cloud/spring-cloud-commons/pull/1361</a></li></ul></article><div class=next-prev><hr><div class="page-navi flex" id=pagenavi><div class=pre-page>←
<a href=https://wangy325.github.io/en/posts/2025/20250110_CSRF_in_spring_security_applications/>How does Spring Security prevent application from CSRF?</a></div><div class=next-page><a href=https://wangy325.github.io/en/posts/2024/20240906_usage_of_hugo_shortcodes/>Usage of Hugo Short Codes</a> →</div></div></div><section class=related><hr></section><div class=book-comments><div class=giscus-thread></div><script src=https://giscus.app/client.js data-repo=wangy325/wangy325.github.io data-repo-id=R_kgDOHhhDZg data-category=Announcements data-category-id=DIC_kwDOHhhDZs4ChbMn data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=noborder_light data-loading=lazy data-lang=en crossorigin=anonymous async></script></div><div class=copyright><hr class=cline><p>Notes and Memos by wangy325
<a href=https://creativecommons.org/licenses/by/4.0/deed.en title="Creative Commons Attribution">&copy; CC BY 4.0</a></p><p>2019-2025. Powered by
<a href=https://github.com/alex-shpak/hugo-book>Hugo Book</a>
Presented by Github.</p></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><div id=toc-new><ul class=nav><li class=nav-item><a id=t1Nospringconfigimportpropertyhasbeendefined href=javascript:void(0) onclick='return scrolly("1-no-springconfigimport-property-has-been-defined"),!1'>1) No spring.config.import property has been defined</a></li><li class=nav-item><a id=t2SpringcloudconfigGitbackendwithsshauthentication href=javascript:void(0) onclick='return scrolly("2-spring-cloud-config-git-backend-with-ssh-authentication"),!1'>2) Spring cloud config Git backend with ssh authentication</a></li><li class=nav-item><a id=t3ConfigsensitiveinfoasenvvariablesinDockerCompose href=javascript:void(0) onclick='return scrolly("3-config-sensitive-info-as-env-variables-in-docker-compose"),!1'>3) Config sensitive info as env variables in Docker Compose</a></li><li class=nav-item><a id=t4DebugMicroServicelocallywithdockerandIDEA href=javascript:void(0) onclick='return scrolly("4-debug-micro-service-locally-with-docker-and-idea"),!1'>4) Debug Micro Service locally with docker and IDEA</a></li><li class=nav-item><a id=t5SpringClouddiscoveryclientandloadbalancer href=javascript:void(0) onclick='return scrolly("5-spring-cloud-discovery-client-and-loadbalancer"),!1'>5) Spring-Cloud discovery client and loadbalancer</a><ul class=nav><li class=nav-item><a id=t51DiscoveryClientNotrecommended href=javascript:void(0) onclick='return scrolly("51-discoveryclient-not-recommended"),!1'>5.1 DiscoveryClient (Not recommended)</a></li><li class=nav-item><a id=t52RestTemplatewithLoadBalanced href=javascript:void(0) onclick='return scrolly("52-resttemplate-with-loadbalanced"),!1'>5.2 RestTemplate with @LoadBalanced</a></li><li class=nav-item><a id=t53OpenFeign href=javascript:void(0) onclick='return scrolly("53-openfeign"),!1'>5.3 OpenFeign</a></li><li class=nav-item><a id=t54Otherapproaches href=javascript:void(0) onclick='return scrolly("54-other-approaches"),!1'>5.4 Other approaches</a><ul class=nav><li class=nav-item><a id=tUsingaReactiveLoadBalancedWebClients href=javascript:void(0) onclick='return scrolly("using-a-reactiveloadbalanced-webclients"),!1'>Using a ReactiveLoadBalanced WebClients</a></li></ul></li></ul></li></ul></div><script>function scrolly(e){const t=40;var n=document.getElementById(e).offsetTop;window.scrollTo({top:n+t,behaviour:"smooth"})}</script></div></aside></main><div class=back-to-top><div id=back-to-top><img src=/svg/chevrons-up.svg srcset="/svg/chevrons-up.svg 500w" onclick=topFunction() class=black>
<img title='Back to top' src=/svg/chevrons-up-blue.svg srcset="/svg/chevrons-up-blue.svg 500w" onclick=topFunction() class=blue></div><script>let mybutton=document.getElementById("back-to-top");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>500||document.documentElement.scrollTop>500?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){window.scrollTo({top:0,behavior:"smooth"})}</script></div><script src=/js/scroll-listening.js></script></body></html>